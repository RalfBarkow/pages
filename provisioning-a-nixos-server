{
  "title": "Provisioning a NixOS Server",
  "story": [
    {
      "type": "paragraph",
      "id": "d3b9947f1e52ab93",
      "text": "Provisioning a NixOS server from macOS [https://medium.com/@zw3rk/provisioning-a-nixos-server-from-macos-d36055afc4ad post]"
    },
    {
      "type": "paragraph",
      "id": "436406843630ca5f",
      "text": "Nix is a purely functional package manager and NixOS is a purely functional Linux distribution. I have been running a NixOS server for a while now, and been quite happy with the configuration. However updating it has essentially been copying the configuration.nix file over and calling nixos-rebuild switch --upgrade. This builds packages that are not in the cache on the server. NixOps is the NixOS cloud deployment tool and I should be able to use it to provision the server. Specifically using NixOps on macOS seems to be rather uncommon. I’ll detail my process, so that we all may benefit from using NixOps on macOS to provision a NixOS linux server."
    },
    {
      "type": "paragraph",
      "id": "751550bce2afe637",
      "text": "Docker Desktop [https://www.docker.com/products/docker-desktop site]"
    },
    {
      "type": "code",
      "id": "2a80971f0ebd2c0e",
      "text": "$ brew install homebrew/cask/docker"
    },
    {
      "type": "code",
      "id": "83bce27a0c40051f",
      "text": "$ docker run --rm -it lnl7/nix"
    },
    {
      "type": "code",
      "id": "a210316cd24b8204",
      "text": "bash-4.4# nix repl '<nixpkgs>'"
    },
    {
      "type": "code",
      "id": "c43592f12ca00265",
      "text": "✗ docker run --rm -it lnl7/nix nix repl '<nixpkgs>'"
    },
    {
      "type": "code",
      "id": "80ef60fa2f780281",
      "text": "nix-repl> system\n\"x86_64-linux\""
    },
    {
      "type": "paragraph",
      "id": "b9934e8861a70162",
      "text": "See [[nix-docker]]"
    },
    {
      "type": "paragraph",
      "id": "e3c3803aedcd9d28",
      "text": "Next: To turn that into a – could we please find a better word than – \"[[build slave]]\""
    }
  ],
  "journal": [
    {
      "type": "create",
      "item": {
        "title": "Provisioning a NixOS Server",
        "story": []
      },
      "date": 1637749666875
    },
    {
      "item": {
        "type": "factory",
        "id": "d3b9947f1e52ab93"
      },
      "id": "d3b9947f1e52ab93",
      "type": "add",
      "date": 1637749686584
    },
    {
      "type": "edit",
      "id": "d3b9947f1e52ab93",
      "item": {
        "type": "paragraph",
        "id": "d3b9947f1e52ab93",
        "text": "https://medium.com/@zw3rk/provisioning-a-nixos-server-from-macos-d36055afc4ad"
      },
      "date": 1637749689104
    },
    {
      "item": {
        "type": "factory",
        "id": "d28e8f2663696dfc"
      },
      "id": "d28e8f2663696dfc",
      "type": "add",
      "after": "d3b9947f1e52ab93",
      "date": 1637749691926
    },
    {
      "type": "edit",
      "id": "d3b9947f1e52ab93",
      "item": {
        "type": "paragraph",
        "id": "d3b9947f1e52ab93",
        "text": "[https://medium.com/@zw3rk/provisioning-a-nixos-server-from-macos-d36055afc4ad post]"
      },
      "date": 1637749746877
    },
    {
      "type": "edit",
      "id": "d3b9947f1e52ab93",
      "item": {
        "type": "paragraph",
        "id": "d3b9947f1e52ab93",
        "text": "Provisioning a NixOS server from macOS [https://medium.com/@zw3rk/provisioning-a-nixos-server-from-macos-d36055afc4ad post]"
      },
      "date": 1637749763451
    },
    {
      "type": "add",
      "id": "751550bce2afe637",
      "item": {
        "type": "paragraph",
        "id": "751550bce2afe637",
        "text": "Docker Desktop [site]"
      },
      "after": "d3b9947f1e52ab93",
      "date": 1637749825418
    },
    {
      "type": "edit",
      "id": "751550bce2afe637",
      "item": {
        "type": "paragraph",
        "id": "751550bce2afe637",
        "text": "Docker Desktop [https://www.docker.com/products/docker-desktop site]"
      },
      "date": 1637749831875
    },
    {
      "type": "edit",
      "id": "d28e8f2663696dfc",
      "item": {
        "type": "reference",
        "id": "d28e8f2663696dfc",
        "site": "eric.dojo.fed.wiki",
        "slug": "pull-request",
        "title": "Pull Request",
        "text": "Pull Request is a feature of GitHub that programmers use to suggest improvements to other projects. This page is about a specific pull request which introduced SVG support into Wiki's HTML Plugin. [https://github.com/fedwiki/wiki-plugin-html/pull/21 github]"
      },
      "date": 1637750258700
    },
    {
      "id": "d28e8f2663696dfc",
      "type": "remove",
      "date": 1637750284066
    },
    {
      "item": {
        "type": "factory",
        "id": "436406843630ca5f"
      },
      "id": "436406843630ca5f",
      "type": "add",
      "after": "751550bce2afe637",
      "date": 1637767184027
    },
    {
      "type": "edit",
      "id": "436406843630ca5f",
      "item": {
        "type": "paragraph",
        "id": "436406843630ca5f",
        "text": "Nix is a purely functional package manager and NixOS is a purely functional Linux distribution. I have been running a NixOS server for a while now, and been quite happy with the configuration. However updating it has essentially been copying the configuration.nix file over and calling nixos-rebuild switch --upgrade. This builds packages that are not in the cache on the server. NixOps is the NixOS cloud deployment tool and I should be able to use it to provision the server. Specifically using NixOps on macOS seems to be rather uncommon. I’ll detail my process, so that we all may benefit from using NixOps on macOS to provision a NixOS linux server."
      },
      "date": 1637767190115
    },
    {
      "id": "436406843630ca5f",
      "type": "move",
      "order": [
        "d3b9947f1e52ab93",
        "436406843630ca5f",
        "751550bce2afe637"
      ],
      "date": 1637767192981
    },
    {
      "item": {
        "type": "factory",
        "id": "a210316cd24b8204"
      },
      "id": "a210316cd24b8204",
      "type": "add",
      "after": "751550bce2afe637",
      "date": 1637859859638
    },
    {
      "type": "edit",
      "id": "a210316cd24b8204",
      "item": {
        "type": "code",
        "id": "a210316cd24b8204",
        "text": "bash-4.4# nix repl '<nixpkgs>'"
      },
      "date": 1637859913404
    },
    {
      "item": {
        "type": "factory",
        "id": "83bce27a0c40051f"
      },
      "id": "83bce27a0c40051f",
      "type": "add",
      "after": "a210316cd24b8204",
      "date": 1637859922809
    },
    {
      "type": "fork",
      "date": 1637859937044
    },
    {
      "type": "fork",
      "date": 1637859938860
    },
    {
      "type": "edit",
      "id": "83bce27a0c40051f",
      "item": {
        "type": "code",
        "id": "83bce27a0c40051f",
        "text": "$ docker run --rm -it lnl7/nix"
      },
      "date": 1637859964052
    },
    {
      "id": "83bce27a0c40051f",
      "type": "move",
      "order": [
        "d3b9947f1e52ab93",
        "436406843630ca5f",
        "751550bce2afe637",
        "83bce27a0c40051f",
        "a210316cd24b8204"
      ],
      "date": 1637859966530
    },
    {
      "item": {
        "type": "factory",
        "id": "2a80971f0ebd2c0e"
      },
      "id": "2a80971f0ebd2c0e",
      "type": "add",
      "after": "a210316cd24b8204",
      "date": 1637860013326
    },
    {
      "type": "edit",
      "id": "2a80971f0ebd2c0e",
      "item": {
        "type": "code",
        "id": "2a80971f0ebd2c0e",
        "text": "$ brew install homebrew/cask/docker"
      },
      "date": 1637860015594
    },
    {
      "id": "2a80971f0ebd2c0e",
      "type": "move",
      "order": [
        "d3b9947f1e52ab93",
        "436406843630ca5f",
        "751550bce2afe637",
        "2a80971f0ebd2c0e",
        "83bce27a0c40051f",
        "a210316cd24b8204"
      ],
      "date": 1637860018065
    },
    {
      "item": {
        "type": "factory",
        "id": "c43592f12ca00265"
      },
      "id": "c43592f12ca00265",
      "type": "add",
      "after": "a210316cd24b8204",
      "date": 1637860375663,
      "error": {
        "type": "error",
        "msg": "Forbidden",
        "response": "Forbidden"
      }
    },
    {
      "type": "edit",
      "id": "c43592f12ca00265",
      "item": {
        "type": "code",
        "id": "c43592f12ca00265",
        "text": "✗ docker run --rm -it lnl7/nix nix repl '<nixpkgs>'"
      },
      "date": 1637860378656,
      "error": {
        "type": "error",
        "msg": "Forbidden",
        "response": "Forbidden"
      }
    },
    {
      "type": "fork",
      "date": 1637861096758,
      "error": {
        "type": "error",
        "msg": "Forbidden",
        "response": "Forbidden"
      }
    },
    {
      "type": "fork",
      "date": 1637861142502
    },
    {
      "item": {
        "type": "factory",
        "id": "80ef60fa2f780281"
      },
      "id": "80ef60fa2f780281",
      "type": "add",
      "after": "c43592f12ca00265",
      "date": 1637861186074
    },
    {
      "type": "edit",
      "id": "80ef60fa2f780281",
      "item": {
        "type": "code",
        "id": "80ef60fa2f780281",
        "text": "nix-repl> system\n\"x86_64-linux\""
      },
      "date": 1637861188437
    },
    {
      "item": {
        "type": "factory",
        "id": "b9934e8861a70162"
      },
      "id": "b9934e8861a70162",
      "type": "add",
      "after": "80ef60fa2f780281",
      "date": 1637868159087
    },
    {
      "type": "edit",
      "id": "b9934e8861a70162",
      "item": {
        "type": "paragraph",
        "id": "b9934e8861a70162",
        "text": "See [[nix-docker]]"
      },
      "date": 1637868165362
    },
    {
      "item": {
        "type": "factory",
        "id": "e3c3803aedcd9d28"
      },
      "id": "e3c3803aedcd9d28",
      "type": "add",
      "after": "b9934e8861a70162",
      "date": 1637875903975
    },
    {
      "type": "edit",
      "id": "e3c3803aedcd9d28",
      "item": {
        "type": "paragraph",
        "id": "e3c3803aedcd9d28",
        "text": "Next: To turn that into a [[build slave]]"
      },
      "date": 1637875927040
    },
    {
      "type": "add",
      "id": "408de6996da573d2",
      "item": {
        "type": "paragraph",
        "id": "408de6996da573d2",
        "text": "Could we please find a better word than \" build slave\"?"
      },
      "after": "e3c3803aedcd9d28",
      "date": 1637876289989
    },
    {
      "type": "edit",
      "id": "e3c3803aedcd9d28",
      "item": {
        "type": "paragraph",
        "id": "e3c3803aedcd9d28",
        "text": "Next: To turn that into a –"
      },
      "date": 1637876309430
    },
    {
      "type": "remove",
      "id": "408de6996da573d2",
      "date": 1637876312618
    },
    {
      "type": "edit",
      "id": "e3c3803aedcd9d28",
      "item": {
        "type": "paragraph",
        "id": "e3c3803aedcd9d28",
        "text": "Next: To turn that into a – could we please find a better word than – \"[[build slave]]\"?"
      },
      "date": 1637876326089
    },
    {
      "type": "edit",
      "id": "e3c3803aedcd9d28",
      "item": {
        "type": "paragraph",
        "id": "e3c3803aedcd9d28",
        "text": "Next: To turn that into a – could we please find a better word than – \"[[build slave]]\""
      },
      "date": 1637876345669
    }
  ]
}