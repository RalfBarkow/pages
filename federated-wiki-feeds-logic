{
  "title": "Federated Wiki Feeds Logic",
  "story": [
    {
      "type": "paragraph",
      "id": "0b5ceb79f4044cb7",
      "text": "The background wiki checking logic is that every wiki in the [http://feeds.fedwikiriver.com/allfeeds.opml all feeds list] gets checked once an hour and any wikis [[flagged as active]] are checked once a minute."
    },
    {
      "type": "paragraph",
      "id": "68473c1dc8ea4397",
      "text": "When a wikis sitemap is pulled, if I find that it's updated I update my cached copy and ping the rssCloud server of an update."
    },
    {
      "type": "paragraph",
      "id": "f5ae2b01d740cb1c",
      "text": "I also fetch a copy of wikis from search.fed.wiki.org and every minute take five wikis from that list and see if I can get a list of peers for it.  If it doesn't have the \"present\" plugin enabled, it returns one item."
    },
    {
      "type": "paragraph",
      "id": "b05a683b5d9c5b7f",
      "text": "Any wiki in the list of peers that I haven't seen before gets added to the all feeds list as active, although if it isn't active it will get flagged as inactive after the first pull of its sitemap."
    },
    {
      "type": "paragraph",
      "id": "85d8c3ed49cbcf71",
      "text": "This way, any wiki that is updated regularly should have updates show up in the river within a minute (or so) while stale wikis that don't get updated regularly don't gum up the system."
    },
    {
      "type": "paragraph",
      "id": "0aa9f1a97002d828",
      "text": "Rosters needed special logic. Most rosters in the fediverse won't need to be fetched on a regular basis because nobody is viewing their river."
    },
    {
      "type": "paragraph",
      "id": "f4046b39da96b0f7",
      "text": "However, fetching a roster the first time can be slow. Especially if it links out to other rosters or lists of references."
    },
    {
      "type": "paragraph",
      "id": "27e6628c23f1895d",
      "text": "So if a roster list or river is fetched, it will be added to a list of active rosters. These rosters will be checked at a rate of one roster a minute in a loop. If the list or river hasn't been fetched in over two weeks it's dropped from the list of active rosters and won't be kept fresh in the cache."
    }
  ],
  "journal": [
    {
      "type": "create",
      "item": {
        "title": "Federated Wiki Feeds Logic",
        "story": []
      },
      "date": 1640989020149
    },
    {
      "id": "69b07243dbe79809",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "69b07243dbe79809",
        "text": "Federated Wiki Feeds is coming together. After the initial release, I found that subscribing to it with [[River5]] left something to be desired."
      },
      "date": 1640989025797
    },
    {
      "id": "69b07243dbe79809",
      "type": "remove",
      "date": 1640989031630
    },
    {
      "id": "0b5ceb79f4044cb7",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "0b5ceb79f4044cb7",
        "text": "The logic is that every wiki in the all feeds list gets checked once an hour and any wikis flagged as active are checked once a minute."
      },
      "date": 1640989041939
    },
    {
      "id": "68473c1dc8ea4397",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "68473c1dc8ea4397",
        "text": "When a wikis sitemap is pulled, if I find that it's updated I update my cached copy and ping the rssCloud server of an update."
      },
      "after": "0b5ceb79f4044cb7",
      "date": 1640989053661
    },
    {
      "id": "f5ae2b01d740cb1c",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "f5ae2b01d740cb1c",
        "text": "I also fetch a copy of wikis from search.fed.wiki.org and every minute take five wikis from that list and see if I can get a list of peers for it.  If it doesn't have the \"present\" plugin enabled, it returns one item."
      },
      "after": "68473c1dc8ea4397",
      "date": 1640989064183
    },
    {
      "id": "b05a683b5d9c5b7f",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "b05a683b5d9c5b7f",
        "text": "Any wiki in the list of peers that I haven't seen before gets added to the all feeds list as active, although if it isn't active it will get flagged as inactive after the first pull of its sitemap."
      },
      "after": "f5ae2b01d740cb1c",
      "date": 1640989071474
    },
    {
      "id": "85d8c3ed49cbcf71",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "85d8c3ed49cbcf71",
        "text": "This way, any wiki that is updated regularly should have updates show up in the river within a minute (or so) while stale wikis that don't get updated regularly don't gum up the system."
      },
      "after": "b05a683b5d9c5b7f",
      "date": 1640989076674
    },
    {
      "type": "edit",
      "id": "0b5ceb79f4044cb7",
      "item": {
        "type": "paragraph",
        "id": "0b5ceb79f4044cb7",
        "text": "The background wiki checking logic is that every wiki in the [all feeds list] gets checked once an hour and any wikis flagged as active are checked once a minute."
      },
      "date": 1640989128037
    },
    {
      "type": "edit",
      "id": "0b5ceb79f4044cb7",
      "item": {
        "type": "paragraph",
        "id": "0b5ceb79f4044cb7",
        "text": "The background wiki checking logic is that every wiki in the [http://feeds.fedwikiriver.com/allfeeds.opml all feeds list] gets checked once an hour and any wikis flagged as active are checked once a minute."
      },
      "date": 1640989149957
    },
    {
      "type": "edit",
      "id": "0b5ceb79f4044cb7",
      "item": {
        "type": "paragraph",
        "id": "0b5ceb79f4044cb7",
        "text": "The background wiki checking logic is that every wiki in the [http://feeds.fedwikiriver.com/allfeeds.opml all feeds list] gets checked once an hour and any wikis [[flagged as active]] are checked once a minute."
      },
      "date": 1640989178376
    },
    {
      "item": {
        "type": "factory",
        "id": "0aa9f1a97002d828"
      },
      "id": "0aa9f1a97002d828",
      "type": "add",
      "after": "85d8c3ed49cbcf71",
      "date": 1650564891093
    },
    {
      "type": "edit",
      "id": "0aa9f1a97002d828",
      "item": {
        "type": "paragraph",
        "id": "0aa9f1a97002d828",
        "text": "Rosters needed special logic. Most rosters in the fediverse won't need to be fetched on a regular basis because nobody is viewing their river."
      },
      "date": 1650564968431
    },
    {
      "type": "add",
      "id": "f4046b39da96b0f7",
      "item": {
        "type": "paragraph",
        "id": "f4046b39da96b0f7",
        "text": "However, fetching a roster the first time can be slow. Especially if it links out to other rosters or lists of references."
      },
      "after": "0aa9f1a97002d828",
      "date": 1650565006774
    },
    {
      "type": "add",
      "id": "27e6628c23f1895d",
      "item": {
        "type": "paragraph",
        "id": "27e6628c23f1895d",
        "text": "So if a roster list or river is fetched, it will be added to a list of active rosters. These rosters will be checked at a rate of one roster a minute in a loop. If the list or river hasn't been fetched in over two weeks it's dropped from the list of active rosters and won't be kept fresh in the cache."
      },
      "after": "f4046b39da96b0f7",
      "date": 1650565144342
    },
    {
      "type": "fork",
      "site": "andrew.shll.wiki",
      "date": 1650985380808
    },
    {
      "type": "fork",
      "date": 1650985382637
    }
  ]
}