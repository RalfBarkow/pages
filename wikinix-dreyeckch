{
  "title": "wiki.nix @dreyeck.ch",
  "story": [
    {
      "type": "paragraph",
      "id": "bbb2cee9fc18e4db",
      "text": "Note: systemd.services.elm-pages is not yet part of the production environment."
    },
    {
      "type": "paragraph",
      "id": "64692f53e077b57c",
      "text": "See NixOS manual \"Definition of systemd service units\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page], systemd.service [https://www.freedesktop.org/software/systemd/man/systemd.service.html page], and \"Execution environment configuration\" (Paths) [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths page] for details."
    },
    {
      "type": "paragraph",
      "id": "45ad2b1c5d0fbc64",
      "text": "wiki.nix:"
    },
    {
      "type": "code",
      "id": "485e38196f0792a4",
      "text": "{config, ...}:\n\n{\n  systemd.services.wiki = {\n    wantedBy = [ \"multi-user.target\" ];\n    after = [ \"network.target\" ];\n    description = \"Federated Wiki (Node.js server version)\";\n    serviceConfig = {\n      Type = \"simple\";\n      User = \"rgb\";\n      # /nix/store/c7k8mr6d7fmqf1ghmngqjyhky42k8mba-node_wiki-0.28.1\n      # /nix/store/c3cr1n5pgmbxblsxcac8ac4yki04hp32-wiki-0.30.0/\n      # /nix/store/3s5lzzrsy18ypas2jzflhfjlyrvj3wnd-wiki-0.31.0/\n\n      ExecStart =\n        \"/nix/store/3s5lzzrsy18ypas2jzflhfjlyrvj3wnd-wiki-0.31.0/bin/wiki --config /home/rgb/.wiki/config.json\";\n      Restart = \"on-failure\";\n    };\n  };\n\n   systemd.services.elm-pages = {\n    wantedBy = [ \"multi-user.target\" ];\n    after = [ \"network.target\" ];\n    description = \"blog.dreyeck.ch/elm-pages-starter-express\";\n    serviceConfig = {\n      Type = \"simple\";\n      User = \"rgb\";\n      WorkingDirectory = \"/home/rgb/.wiki/blog.dreyeck.ch/elm-pages-starter-express\";\n      ExecStart = \"/run/current-system/sw/bin/npm start\";\n                # /nix/store/3w6dcj7vi42w45q8mc5drb5ndcvzjhqy-nodejs-18.14.1/bin/npm\n      Restart = \"on-failure\";\n    };\n  };\n\n}\n"
    },
    {
      "type": "paragraph",
      "id": "94e0986eed1ab616",
      "text": "⇐ [[elm-pages.service]]"
    },
    {
      "type": "paragraph",
      "id": "73dc13c5bdafee9c",
      "text": "⇒ elm-pages-starter-express/package.json [https://github.com/dreyeck/blog/blob/27ba4048efae557d442773d44f0ba54715f627e6/elm-pages-starter-express/package.json#L8 code]"
    },
    {
      "type": "code",
      "id": "e59f4d6078a05bf9",
      "text": "    \"start\": \"node dist-server/server.mjs\""
    }
  ],
  "journal": [
    {
      "type": "create",
      "item": {
        "title": "wiki.nix @dreyeck.ch",
        "story": []
      },
      "date": 1694001439137
    },
    {
      "item": {
        "type": "factory",
        "id": "485e38196f0792a4"
      },
      "id": "485e38196f0792a4",
      "type": "add",
      "date": 1694001440999
    },
    {
      "type": "edit",
      "id": "485e38196f0792a4",
      "item": {
        "type": "code",
        "id": "485e38196f0792a4",
        "text": "{config, ...}:\n\n{\n  systemd.services.wiki = {\n    wantedBy = [ \"multi-user.target\" ];\n    after = [ \"network.target\" ];\n    description = \"Federated Wiki (Node.js server version)\";\n    serviceConfig = {\n      Type = \"simple\";\n      User = \"rgb\";\n      # /nix/store/c7k8mr6d7fmqf1ghmngqjyhky42k8mba-node_wiki-0.28.1\n      # /nix/store/c3cr1n5pgmbxblsxcac8ac4yki04hp32-wiki-0.30.0/\n      # /nix/store/3s5lzzrsy18ypas2jzflhfjlyrvj3wnd-wiki-0.31.0/\n\n      ExecStart =\n        \"/nix/store/3s5lzzrsy18ypas2jzflhfjlyrvj3wnd-wiki-0.31.0/bin/wiki --config /home/rgb/.wiki/config.json\";\n      Restart = \"on-failure\";\n    };\n  };\n\n   systemd.services.elm-pages = {\n    wantedBy = [ \"multi-user.target\" ];\n    after = [ \"network.target\" ];\n    description = \"blog.dreyeck.ch/elm-pages-starter-express\";\n    serviceConfig = {\n      Type = \"simple\";\n      User = \"rgb\";\n      WorkingDirectory = \"/home/rgb/.wiki/blog.dreyeck.ch/elm-pages-starter-express\";\n      ExecStart = \"/run/current-system/sw/bin/npm start\";\n                # /nix/store/3w6dcj7vi42w45q8mc5drb5ndcvzjhqy-nodejs-18.14.1/bin/npm\n      Restart = \"on-failure\";\n    };\n  };\n\n}\n"
      },
      "date": 1694001443261
    },
    {
      "item": {
        "type": "factory",
        "id": "94e0986eed1ab616"
      },
      "id": "94e0986eed1ab616",
      "type": "add",
      "after": "485e38196f0792a4",
      "date": 1694001550339
    },
    {
      "type": "edit",
      "id": "94e0986eed1ab616",
      "item": {
        "type": "paragraph",
        "id": "94e0986eed1ab616",
        "text": "⇐ [[elm-pages.service]]"
      },
      "date": 1694001568385
    },
    {
      "type": "add",
      "id": "bbb2cee9fc18e4db",
      "item": {
        "type": "paragraph",
        "id": "bbb2cee9fc18e4db",
        "text": "Note: "
      },
      "after": "94e0986eed1ab616",
      "date": 1694001589416
    },
    {
      "type": "edit",
      "id": "bbb2cee9fc18e4db",
      "item": {
        "type": "paragraph",
        "id": "bbb2cee9fc18e4db",
        "text": "Note: systemd.services.elm-pages "
      },
      "date": 1694001605852
    },
    {
      "type": "edit",
      "id": "bbb2cee9fc18e4db",
      "item": {
        "type": "paragraph",
        "id": "bbb2cee9fc18e4db",
        "text": "Note: systemd.services.elm-pages is not yet part of the production environment."
      },
      "date": 1694001635605
    },
    {
      "id": "bbb2cee9fc18e4db",
      "type": "move",
      "order": [
        "bbb2cee9fc18e4db",
        "485e38196f0792a4",
        "94e0986eed1ab616"
      ],
      "date": 1694003841252
    },
    {
      "type": "edit",
      "id": "bbb2cee9fc18e4db",
      "item": {
        "type": "paragraph",
        "id": "bbb2cee9fc18e4db",
        "text": "Note: systemd.services.elm-pages is not yet part of the production environment. [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page]"
      },
      "date": 1694004086294
    },
    {
      "type": "edit",
      "id": "bbb2cee9fc18e4db",
      "item": {
        "type": "paragraph",
        "id": "bbb2cee9fc18e4db",
        "text": "Note: systemd.services.elm-pages is not yet part of the production environment."
      },
      "date": 1694004104500
    },
    {
      "type": "add",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units.\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page]"
      },
      "after": "bbb2cee9fc18e4db",
      "date": 1694004108006
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units.\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page] ()"
      },
      "date": 1694004143918
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units.\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page] () and systemd.service(5) for details."
      },
      "date": 1694004215073
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units.\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page] () and [https://www.freedesktop.org/software/systemd/man/systemd.service.html systemd.service(5)] for details."
      },
      "date": 1694004231182
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units.\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page] () and [https://www.freedesktop.org/software/systemd/man/systemd.service.html systemd.service(5)] for details. [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths Paths]"
      },
      "date": 1694004382876
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units.\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page] (Appendix A. Configuration Options) and [https://www.freedesktop.org/software/systemd/man/systemd.service.html systemd.service(5)] for details. [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths Paths]"
      },
      "date": 1694004492487
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units.\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page] (Appendix A. Configuration Options), [https://www.freedesktop.org/software/systemd/man/systemd.service.html systemd.service(5)] and [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths Paths] for details."
      },
      "date": 1694004563086
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units.\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page] (Appendix A. Configuration Options), [https://www.freedesktop.org/software/systemd/man/systemd.service.html systemd.service(5)], and [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths Paths] for details."
      },
      "date": 1694004593579
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units.\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page] (Appendix A. Configuration Options), [https://www.freedesktop.org/software/systemd/man/systemd.service.html systemd.service(5)], and Execution environment configuration [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths page] for details."
      },
      "date": 1694004619523
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page] (Appendix A. Configuration Options), [https://www.freedesktop.org/software/systemd/man/systemd.service.html systemd.service(5)], and Execution environment configuration [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths page] for details."
      },
      "date": 1694004637585
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page], [https://www.freedesktop.org/software/systemd/man/systemd.service.html systemd.service(5)], and Execution environment configuration [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths page] for details."
      },
      "date": 1694004651215
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page], [https://www.freedesktop.org/software/systemd/man/systemd.service.html systemd.service(5)], and \"Execution environment configuration\" [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths page] for details."
      },
      "date": 1694004687776
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See \"Definition of systemd service units\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page], \"Service unit configuration\" [https://www.freedesktop.org/software/systemd/man/systemd.service.html page], and \"Execution environment configuration\" [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths page] for details."
      },
      "date": 1694004722393
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See NixOS manual \"Definition of systemd service units\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page], \"Service unit configuration\" [https://www.freedesktop.org/software/systemd/man/systemd.service.html page], and \"Execution environment configuration\" [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths page] for details."
      },
      "date": 1694004770800
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See NixOS manual \"Definition of systemd service units\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page], \"Service unit configuration\" [https://www.freedesktop.org/software/systemd/man/systemd.service.html page], and \"Execution environment configuration\" (Paths) [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths page] for details."
      },
      "date": 1694004814767
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See NixOS manual \"Definition of systemd service units\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page], systemd.service \"Service unit configuration\" [https://www.freedesktop.org/software/systemd/man/systemd.service.html page], and \"Execution environment configuration\" (Paths) [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths page] for details."
      },
      "date": 1694004925172
    },
    {
      "type": "edit",
      "id": "64692f53e077b57c",
      "item": {
        "type": "paragraph",
        "id": "64692f53e077b57c",
        "text": "See NixOS manual \"Definition of systemd service units\" [https://nixos.org/manual/nixos/stable/options#opt-systemd.services page], systemd.service [https://www.freedesktop.org/software/systemd/man/systemd.service.html page], and \"Execution environment configuration\" (Paths) [https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Paths page] for details."
      },
      "date": 1694004960580
    },
    {
      "type": "add",
      "id": "45ad2b1c5d0fbc64",
      "item": {
        "type": "paragraph",
        "id": "45ad2b1c5d0fbc64",
        "text": "wiki.nix:"
      },
      "after": "64692f53e077b57c",
      "date": 1694005206628
    },
    {
      "id": "73dc13c5bdafee9c",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "73dc13c5bdafee9c",
        "text": "⇒ elm-pages-starter-express/package.json [https://github.com/dreyeck/blog/blob/27ba4048efae557d442773d44f0ba54715f627e6/elm-pages-starter-express/package.json#L8 code]"
      },
      "after": "94e0986eed1ab616",
      "attribution": {
        "page": "elm-pages.service"
      },
      "date": 1694005338134
    },
    {
      "id": "e59f4d6078a05bf9",
      "type": "add",
      "item": {
        "type": "code",
        "id": "e59f4d6078a05bf9",
        "text": "    \"start\": \"node dist-server/server.mjs\""
      },
      "after": "73dc13c5bdafee9c",
      "attribution": {
        "page": "elm-pages.service"
      },
      "date": 1694005342109
    }
  ]
}