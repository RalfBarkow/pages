{
  "title": "Global Variables And Virtual Machines",
  "story": [
    {
      "type": "html",
      "text": "I was perusing some code recently, found a [[Singleton]], and thought \"if I ran two copies of the application, would I need another one of these?\"",
      "id": "1711bfe05b52651c7213ca59b2ea72f0"
    },
    {
      "type": "html",
      "text": "\nGlobal variables are evil, but nobody really needs to be told that. The problem is when they're considered a necessary evil, or a convenient evil, tolerated in order to store data that most of your objects need easy access to, and that would be too much effort to pass around explicitly.  ",
      "id": "4e55bc6ad010e5a235ccb4d163f45e94"
    },
    {
      "type": "html",
      "text": "\nIn an application that runs in regular process-space, the scope of a global variable encompasses the application, and nothing more. Running (in my case) Java on its virtual machine, the scope of a static variable encompasses the entire virtual machine, and any other applications (or copies of the same application) you may have running on it. Web application servers will run all your web applications in the same VM unless you order them not to. MacOS X claims to reduce Java overhead \"through the sharing of Java class data and [[Hot Spot]] compiled code across invocations\", so you can't trust the Operating System not to cheat and cram separate applications into the one VM. ",
      "id": "686796b5611c1f9dcf8ebcca66a9ef67"
    },
    {
      "type": "html",
      "text": "\nThus, in a [[Virtual Machine]] environment, something can be global only if it is the only one of these objects that you would wish to be in existence across multiple invocations of your application, and anyone else's application besides.",
      "id": "651a21d883fd1f05ee597f5fa71494a1"
    },
    {
      "type": "html",
      "text": "<i>In LISPs, Perl, etc. you can create a new frame for your application and your application alone. Don't confuse Java with all virtual machines.</i>",
      "id": "29a9b77e34b55486454def15a5e91086"
    },
    {
      "type": "html",
      "text": "\nDon't get Java confused, either. On the Java VM the run-time scope of a public static member is <i>not</i> the entire VM, it is the objects in the VM that are instances of classes loaded by the same classloader that loaded the class of which the static in question is a member. <i>[Not quite; that doesn't take into account classloader delegation.]</i>",
      "id": "fd33dd55b8081289def9f20973786666"
    },
    {
      "type": "html",
      "text": "\nThis is a very practical mechanism, which has been used since Applets to give programs their own namespace within a shared VM.",
      "id": "d0b45567161c5253be051be1a5832f5b"
    },
    {
      "type": "html",
      "text": "\nThe [[Class Loader]] mechanism is powerful, but for various reasons it's not perfect. JSR 121 proposes a more thorough solution: [http://jcp.org/jsr/detail/121.jsp jcp.org].",
      "id": "d415fea4c573abb589e4b121d7385436"
    },
    {
      "type": "html",
      "text": "See original on  [http://c2.com/cgi/wiki?GlobalVariablesAndVirtualMachines c2.com]",
      "id": "35be77441e76c43485147e3a1101ef33"
    },
    {
      "type": "paragraph",
      "id": "0215535e411d6041",
      "text": "See [[Global Object]]."
    }
  ],
  "journal": [
    {
      "date": 1104650123000,
      "id": "d5b7b547d16d1d924f6c436c3e1b8609",
      "type": "create",
      "item": {
        "title": "Global Variables And Virtual Machines",
        "story": [
          {
            "type": "html",
            "text": "I was perusing some code recently, found a Singleton, and thought \"if I ran two copies of the application, would I need another one of these?\"",
            "id": "1711bfe05b52651c7213ca59b2ea72f0"
          },
          {
            "type": "html",
            "text": "\nGlobal variables are evil, but nobody really needs to be told that. The problem is when they're considered a necessary evil, or a convenient evil, tolerated in order to store data that most of your objects need easy access to, and that would be too much effort to pass around explicitly.  ",
            "id": "4e55bc6ad010e5a235ccb4d163f45e94"
          },
          {
            "type": "html",
            "text": "\nIn an application that runs in regular process-space, the scope of a global variable encompasses the application, and nothing more. Running (in my case) Java on its virtual machine, the scope of a static variable encompasses the entire virtual machine, and any other applications (or copies of the same application) you may have running on it. Web application servers will run all your web applications in the same VM unless you order them not to. MacOS X claims to reduce Java overhead \"through the sharing of Java class data and [[Hot Spot]] compiled code across invocations\", so you can't trust the Operating System not to cheat and cram separate applications into the one VM. ",
            "id": "686796b5611c1f9dcf8ebcca66a9ef67"
          },
          {
            "type": "html",
            "text": "\nThus, in a [[Virtual Machine]] environment, something can be global only if it is the only one of these objects that you would wish to be in existence across multiple invocations of your application, and anyone else's application besides.",
            "id": "651a21d883fd1f05ee597f5fa71494a1"
          },
          {
            "type": "html",
            "text": "<i>In LISPs, Perl, etc. you can create a new frame for your application and your application alone. Don't confuse Java with all virtual machines.</i>",
            "id": "29a9b77e34b55486454def15a5e91086"
          },
          {
            "type": "html",
            "text": "\nDon't get Java confused, either. On the Java VM the run-time scope of a public static member is <i>not</i> the entire VM, it is the objects in the VM that are instances of classes loaded by the same classloader that loaded the class of which the static in question is a member. <i>[Not quite; that doesn't take into account classloader delegation.]</i>",
            "id": "fd33dd55b8081289def9f20973786666"
          },
          {
            "type": "html",
            "text": "\nThis is a very practical mechanism, which has been used since Applets to give programs their own namespace within a shared VM.",
            "id": "d0b45567161c5253be051be1a5832f5b"
          },
          {
            "type": "html",
            "text": "\nThe [[Class Loader]] mechanism is powerful, but for various reasons it's not perfect. JSR 121 proposes a more thorough solution: [http://jcp.org/jsr/detail/121.jsp jcp.org].",
            "id": "d415fea4c573abb589e4b121d7385436"
          },
          {
            "type": "html",
            "text": "See original on  [http://c2.com/cgi/wiki?GlobalVariablesAndVirtualMachines c2.com]",
            "id": "35be77441e76c43485147e3a1101ef33"
          }
        ]
      }
    },
    {
      "type": "fork",
      "site": "sfw.c2.com",
      "date": 1644485805882
    },
    {
      "item": {
        "type": "factory",
        "id": "0215535e411d6041"
      },
      "id": "0215535e411d6041",
      "type": "add",
      "after": "35be77441e76c43485147e3a1101ef33",
      "date": 1644675320650
    },
    {
      "type": "edit",
      "id": "0215535e411d6041",
      "item": {
        "type": "paragraph",
        "id": "0215535e411d6041",
        "text": "See [[Global Object]]."
      },
      "date": 1644675330572
    },
    {
      "type": "edit",
      "id": "1711bfe05b52651c7213ca59b2ea72f0",
      "item": {
        "type": "html",
        "text": "I was perusing some code recently, found a [[Singleton]], and thought \"if I ran two copies of the application, would I need another one of these?\"",
        "id": "1711bfe05b52651c7213ca59b2ea72f0"
      },
      "date": 1649934530319
    }
  ]
}