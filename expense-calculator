{
  "title": "Expense Calculator",
  "story": [
    {
      "type": "paragraph",
      "id": "b7c8ba08f201eab4",
      "text": "I wrote the AWK version of this calculator when I volunteered to work out the expenses for our 1981 ski trip to Jackson Hole. [http://c2.com/doc/expense/ webpage]"
    },
    {
      "type": "paragraph",
      "id": "a8a31500802470e6",
      "text": "I wasn't even sure how to approach the calculation so I just started writing facts into a file. Pretty soon I realized that if I could just sum the groups and then bring those sums into other groups then I'd pretty much have it."
    },
    {
      "type": "paragraph",
      "id": "e43384a0d9196819",
      "text": "I wrote AWK to do the calculation and print a report. I made it more general than need be because that was the easiest way to get it right. I finished the script and the report together."
    },
    {
      "type": "paragraph",
      "id": "de3a662a58e08bfb",
      "text": "A key notion is that there is a running sum. This is saved to or restored from a hash when a name is encountered. The first occurrence defines the name; later occurrences recall its value."
    },
    {
      "type": "code",
      "id": "6367328667823688",
      "text": "$1 ~ /^[A-Z]+[A-Z0-9]*$/ {\n  if (sums[$1] == \"\" || $1 == \"SUM\") {\n    # Define Symbol\n    sums[$1] = sum\n    $1 = sum\n    sum = 0\n  }\n  else {\n    # Dereference Symbol\n    $1 = sums[$1]\n  }\n}\n\n# Pretty Print\n($1+0) != 0 {$1 = sprintf(\"%7.2f\", $1)}\n    {print}\n\n# Explicit Calculations\n$2 == \"*\" {$1 *= $3}\n$2 == \"/\" {$1 /= $3}\n$2 == \"DB\"  {$1 = -$1}\n$2 == \"CR\"  {$1 = -$1}\n\n# Implicit Summation\nNF == 0   {sum = 0}\n    {sum += $1}"
    },
    {
      "type": "paragraph",
      "id": "db44cfeacfd943c3",
      "text": "My friend [[Jim Bessemer]] recognized the similarity of my approach with spreadsheet programs which I had not yet used. The common feature is calculation in the context of a document."
    },
    {
      "type": "paragraph",
      "id": "33e9aa2a45cd14e8",
      "text": "Years later I revived the program and recoded it in CoffeeScript as a step toward the calculation methodology for Federated Wiki."
    },
    {
      "type": "paragraph",
      "id": "78183f1650d3d5d4",
      "text": "See [[About Calculator Plugin]]"
    }
  ],
  "journal": [
    {
      "type": "create",
      "item": {
        "title": "Expense Calculator",
        "story": []
      },
      "date": 1391360064301
    },
    {
      "item": {
        "type": "factory",
        "id": "b7c8ba08f201eab4"
      },
      "id": "b7c8ba08f201eab4",
      "type": "add",
      "date": 1391360067972
    },
    {
      "type": "edit",
      "id": "b7c8ba08f201eab4",
      "item": {
        "type": "paragraph",
        "id": "b7c8ba08f201eab4",
        "text": "I wrote this calculator to work "
      },
      "date": 1391360093741
    },
    {
      "item": {
        "type": "factory",
        "id": "78183f1650d3d5d4"
      },
      "id": "78183f1650d3d5d4",
      "type": "add",
      "after": "b7c8ba08f201eab4",
      "date": 1391360099754
    },
    {
      "type": "edit",
      "id": "78183f1650d3d5d4",
      "item": {
        "type": "paragraph",
        "id": "78183f1650d3d5d4",
        "text": "See [[About Calculator Plugin]]"
      },
      "date": 1391360112380
    },
    {
      "type": "edit",
      "id": "b7c8ba08f201eab4",
      "item": {
        "type": "paragraph",
        "id": "b7c8ba08f201eab4",
        "text": "I wrote this calculator when I volunteered to work out the expenses for our 1981 ski trip to Jackson Hole. I wasn't even sure how to approach the calculation so I just started writing facts into a file. Pretty soon I realized that if I could just sum the groups and then bring those sums into other groups then I'd pretty much have it."
      },
      "date": 1391360204828
    },
    {
      "item": {
        "type": "paragraph",
        "id": "e43384a0d9196819",
        "text": "I wrote a small AWK script to do just that and print a report. I finished the script and the report together."
      },
      "id": "e43384a0d9196819",
      "type": "add",
      "after": "b7c8ba08f201eab4",
      "date": 1391360205336
    },
    {
      "type": "edit",
      "id": "b7c8ba08f201eab4",
      "item": {
        "type": "paragraph",
        "id": "b7c8ba08f201eab4",
        "text": "I wrote the AWK version of this calculator when I volunteered to work out the expenses for our 1981 ski trip to Jackson Hole."
      },
      "date": 1391360270417
    },
    {
      "item": {
        "type": "paragraph",
        "id": "a8a31500802470e6",
        "text": "I wasn't even sure how to approach the calculation so I just started writing facts into a file. Pretty soon I realized that if I could just sum the groups and then bring those sums into other groups then I'd pretty much have it."
      },
      "id": "a8a31500802470e6",
      "type": "add",
      "after": "b7c8ba08f201eab4",
      "date": 1391360270924
    },
    {
      "type": "edit",
      "id": "e43384a0d9196819",
      "item": {
        "type": "paragraph",
        "id": "e43384a0d9196819",
        "text": "I wrote a script to do just that and print a report. I finished the script and the report together."
      },
      "date": 1391360310391
    },
    {
      "item": {
        "type": "factory",
        "id": "6367328667823688"
      },
      "id": "6367328667823688",
      "type": "add",
      "after": "78183f1650d3d5d4",
      "date": 1391360674686
    },
    {
      "type": "edit",
      "id": "6367328667823688",
      "item": {
        "type": "code",
        "id": "6367328667823688",
        "text": "exec awk '\n$1 ~ /^[A-Z]+[A-Z0-9]*$/ {\n  if (sums[$1] == \"\" || $1 == \"SUM\") {\n\n    # Define Symbol\n    sums[$1] = sum\n    $1 = sum\n    sum = 0\n  }\n  else {\n\n    # Dereference Symbol\n    $1 = sums[$1]\n  }\n}\n\n# Pretty Print\n($1+0) != 0 {$1 = sprintf(\"%7.2f\", $1)}\n    {print}\n\n# Explicit Calculations\n$2 == \"*\" {$1 *= $3}\n$2 == \"/\" {$1 /= $3}\n$2 == \"DB\"  {$1 = -$1}\n$2 == \"CR\"  {$1 = -$1}\n\n# Implicit Summation\nNF == 0   {sum = 0}\n    {sum += $1}\n' $1"
      },
      "date": 1391360682270
    },
    {
      "type": "edit",
      "id": "6367328667823688",
      "item": {
        "type": "code",
        "id": "6367328667823688",
        "text": "$1 ~ /^[A-Z]+[A-Z0-9]*$/ {\n  if (sums[$1] == \"\" || $1 == \"SUM\") {\n\n    # Define Symbol\n    sums[$1] = sum\n    $1 = sum\n    sum = 0\n  }\n  else {\n\n    # Dereference Symbol\n    $1 = sums[$1]\n  }\n}\n\n# Pretty Print\n($1+0) != 0 {$1 = sprintf(\"%7.2f\", $1)}\n    {print}\n\n# Explicit Calculations\n$2 == \"*\" {$1 *= $3}\n$2 == \"/\" {$1 /= $3}\n$2 == \"DB\"  {$1 = -$1}\n$2 == \"CR\"  {$1 = -$1}\n\n# Implicit Summation\nNF == 0   {sum = 0}\n    {sum += $1}"
      },
      "date": 1391360702537
    },
    {
      "type": "edit",
      "id": "6367328667823688",
      "item": {
        "type": "code",
        "id": "6367328667823688",
        "text": "$1 ~ /^[A-Z]+[A-Z0-9]*$/ {\n  if (sums[$1] == \"\" || $1 == \"SUM\") {\n    # Define Symbol\n    sums[$1] = sum\n    $1 = sum\n    sum = 0\n  }\n  else {\n    # Dereference Symbol\n    $1 = sums[$1]\n  }\n}\n\n# Pretty Print\n($1+0) != 0 {$1 = sprintf(\"%7.2f\", $1)}\n    {print}\n\n# Explicit Calculations\n$2 == \"*\" {$1 *= $3}\n$2 == \"/\" {$1 /= $3}\n$2 == \"DB\"  {$1 = -$1}\n$2 == \"CR\"  {$1 = -$1}\n\n# Implicit Summation\nNF == 0   {sum = 0}\n    {sum += $1}"
      },
      "date": 1391360723295
    },
    {
      "type": "edit",
      "id": "b7c8ba08f201eab4",
      "item": {
        "type": "paragraph",
        "id": "b7c8ba08f201eab4",
        "text": "I wrote the AWK version of this calculator when I volunteered to work out the expenses for our 1981 ski trip to Jackson Hole. [http://c2.com/doc/expense/ webpage]"
      },
      "date": 1391360777476
    },
    {
      "type": "edit",
      "id": "e43384a0d9196819",
      "item": {
        "type": "paragraph",
        "id": "e43384a0d9196819",
        "text": "I wrote AWK to do the calculation and print a report. I made it more general than need be because that was the easiest way to get it right. I finished the script and the report together."
      },
      "date": 1391360913293
    },
    {
      "type": "move",
      "order": [
        "b7c8ba08f201eab4",
        "a8a31500802470e6",
        "e43384a0d9196819",
        "6367328667823688",
        "78183f1650d3d5d4"
      ],
      "id": "78183f1650d3d5d4",
      "date": 1391360923167
    },
    {
      "item": {
        "type": "paragraph",
        "id": "db44cfeacfd943c3",
        "text": ""
      },
      "id": "db44cfeacfd943c3",
      "type": "add",
      "after": "78183f1650d3d5d4",
      "date": 1391360942861
    },
    {
      "type": "edit",
      "id": "db44cfeacfd943c3",
      "item": {
        "type": "paragraph",
        "id": "db44cfeacfd943c3",
        "text": "My friend Jim Bessemer recognized the similarity with spreadsheet programs which I had not yet used."
      },
      "date": 1391361100782
    },
    {
      "item": {
        "type": "paragraph",
        "id": "33e9aa2a45cd14e8",
        "text": "Years later I revived the program and recoded it in CoffeeScript as a step toward the calculation methodology for Federated Wiki."
      },
      "id": "33e9aa2a45cd14e8",
      "type": "add",
      "after": "db44cfeacfd943c3",
      "date": 1391361101290
    },
    {
      "type": "move",
      "order": [
        "b7c8ba08f201eab4",
        "a8a31500802470e6",
        "e43384a0d9196819",
        "6367328667823688",
        "db44cfeacfd943c3",
        "33e9aa2a45cd14e8",
        "78183f1650d3d5d4"
      ],
      "id": "78183f1650d3d5d4",
      "date": 1391361108510
    },
    {
      "item": {
        "type": "paragraph",
        "id": "de3a662a58e08bfb",
        "text": ""
      },
      "id": "de3a662a58e08bfb",
      "type": "add",
      "after": "e43384a0d9196819",
      "date": 1391361236270
    },
    {
      "type": "edit",
      "id": "de3a662a58e08bfb",
      "item": {
        "type": "paragraph",
        "id": "de3a662a58e08bfb",
        "text": "A key notion is that there is a running sum. This is saved to or restored from a hash when a name is encountered in place of digits. The first occurrence defines the name; later occurrences recall its value."
      },
      "date": 1391361372158
    },
    {
      "type": "edit",
      "id": "de3a662a58e08bfb",
      "item": {
        "type": "paragraph",
        "id": "de3a662a58e08bfb",
        "text": "A key notion is that there is a running sum. This is saved to or restored from a hash when a name is encountered. The first occurrence defines the name; later occurrences recall its value."
      },
      "date": 1391361394172
    },
    {
      "type": "edit",
      "id": "db44cfeacfd943c3",
      "item": {
        "type": "paragraph",
        "id": "db44cfeacfd943c3",
        "text": "My friend Jim Bessemer recognized the similarity of my approach with spreadsheet programs which I had not yet used."
      },
      "date": 1391361411588
    },
    {
      "type": "edit",
      "id": "db44cfeacfd943c3",
      "item": {
        "type": "paragraph",
        "id": "db44cfeacfd943c3",
        "text": "My friend Jim Bessemer recognized the similarity of my approach with spreadsheet programs which I had not yet used. The essential feature is calculation in the context of a document."
      },
      "date": 1391361499763
    },
    {
      "type": "edit",
      "id": "db44cfeacfd943c3",
      "item": {
        "type": "paragraph",
        "id": "db44cfeacfd943c3",
        "text": "My friend Jim Bessemer recognized the similarity of my approach with spreadsheet programs which I had not yet used. The common feature is calculation in the context of a document."
      },
      "date": 1391361511618
    },
    {
      "type": "fork",
      "site": "code.fed.wiki.org",
      "date": 1651832646877
    },
    {
      "type": "edit",
      "id": "db44cfeacfd943c3",
      "item": {
        "type": "paragraph",
        "id": "db44cfeacfd943c3",
        "text": "My friend [[Jim Bessemer]] recognized the similarity of my approach with spreadsheet programs which I had not yet used. The common feature is calculation in the context of a document."
      },
      "date": 1651832656480
    }
  ]
}