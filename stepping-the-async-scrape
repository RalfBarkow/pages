{
  "title": "Stepping the Async Scrape",
  "story": [
    {
      "type": "paragraph",
      "id": "6fd987059580e844",
      "text": "We've designed a scrape that runs with some parallelism captured with liberal use of async and await. Now we are thinking we can single-step this long running computation but have to think through what that even means."
    },
    {
      "type": "paragraph",
      "id": "ba4923c13a056877",
      "text": "See [[Search over the Horizon]]"
    },
    {
      "type": "graphviz",
      "id": "2fd6f6cb4a266876",
      "text": "digraph {\n  start\n  sites\n  slugs\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dotime\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dotime -> running -> reschedue\n  dotime -> ready -> start\n  dosite -> update -> modified -> slugs \n  update -> new -> slugs\n  doslug -> item -> sites \n  doslug -> action -> sites\n}\n\n}",
      "dot": "digraph {\n  start\n  sites\n  slugs\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dotime\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dotime -> running -> reschedue\n  dotime -> ready -> start\n  dosite -> update -> modified -> slugs \n  update -> new -> slugs\n  doslug -> item -> sites \n  doslug -> action -> sites\n}\n\n}",
      "svg": "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.44.0 (20200518.1210)\n -->\n<!-- Pages: 1 -->\n<svg width=\"364pt\" height=\"300pt\"\n viewBox=\"0.00 0.00 364.18 300.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 296)\">\n<polygon fill=\"white\" stroke=\"transparent\" points=\"-4,4 -4,-296 360.18,-296 360.18,4 -4,4\"/>\n<!-- start -->\n<g id=\"node1\" class=\"node\">\n<title>start</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"222.42\" cy=\"-18\" rx=\"27.82\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"222.42\" y=\"-13.8\" font-family=\"Times,serif\" font-size=\"14.00\">start</text>\n</g>\n<!-- sites -->\n<g id=\"node2\" class=\"node\">\n<title>sites</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"222.42\" cy=\"-153\" rx=\"28.4\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"222.42\" y=\"-148.8\" font-family=\"Times,serif\" font-size=\"14.00\">sites</text>\n</g>\n<!-- slugs -->\n<g id=\"node3\" class=\"node\">\n<title>slugs</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"325.29\" cy=\"-247\" rx=\"30.78\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"325.29\" y=\"-242.8\" font-family=\"Times,serif\" font-size=\"14.00\">slugs</text>\n</g>\n<!-- dotime -->\n<g id=\"node4\" class=\"node\">\n<title>dotime</title>\n<polygon fill=\"lightblue\" stroke=\"black\" points=\"54.83,-63 0.06,-63 0.06,-27 54.83,-27 54.83,-63\"/>\n<text text-anchor=\"middle\" x=\"27.44\" y=\"-40.8\" font-family=\"Times,serif\" font-size=\"14.00\">dotime</text>\n</g>\n<!-- running -->\n<g id=\"node7\" class=\"node\">\n<title>running</title>\n<polygon fill=\"palegreen\" stroke=\"black\" points=\"150.21,-90 91.11,-90 91.11,-54 150.21,-54 150.21,-90\"/>\n<text text-anchor=\"middle\" x=\"120.66\" y=\"-67.8\" font-family=\"Times,serif\" font-size=\"14.00\">running</text>\n</g>\n<!-- dotime&#45;&gt;running -->\n<g id=\"edge1\" class=\"edge\">\n<title>dotime&#45;&gt;running</title>\n<path fill=\"none\" stroke=\"black\" d=\"M55.32,-52.95C63.49,-55.37 72.63,-58.08 81.4,-60.68\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"80.49,-64.06 91.07,-63.54 82.48,-57.34 80.49,-64.06\"/>\n</g>\n<!-- ready -->\n<g id=\"node9\" class=\"node\">\n<title>ready</title>\n<polygon fill=\"palegreen\" stroke=\"black\" points=\"147.66,-36 93.66,-36 93.66,0 147.66,0 147.66,-36\"/>\n<text text-anchor=\"middle\" x=\"120.66\" y=\"-13.8\" font-family=\"Times,serif\" font-size=\"14.00\">ready</text>\n</g>\n<!-- dotime&#45;&gt;ready -->\n<g id=\"edge3\" class=\"edge\">\n<title>dotime&#45;&gt;ready</title>\n<path fill=\"none\" stroke=\"black\" d=\"M55.32,-37.05C64.29,-34.39 74.43,-31.39 83.97,-28.57\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"85.01,-31.91 93.61,-25.71 83.02,-25.19 85.01,-31.91\"/>\n</g>\n<!-- dosite -->\n<g id=\"node5\" class=\"node\">\n<title>dosite</title>\n<polygon fill=\"lightblue\" stroke=\"black\" points=\"54.44,-272 0.44,-272 0.44,-236 54.44,-236 54.44,-272\"/>\n<text text-anchor=\"middle\" x=\"27.44\" y=\"-249.8\" font-family=\"Times,serif\" font-size=\"14.00\">dosite</text>\n</g>\n<!-- update -->\n<g id=\"node10\" class=\"node\">\n<title>update</title>\n<polygon fill=\"palegreen\" stroke=\"black\" points=\"147.66,-272 93.66,-272 93.66,-236 147.66,-236 147.66,-272\"/>\n<text text-anchor=\"middle\" x=\"120.66\" y=\"-249.8\" font-family=\"Times,serif\" font-size=\"14.00\">update</text>\n</g>\n<!-- dosite&#45;&gt;update -->\n<g id=\"edge5\" class=\"edge\">\n<title>dosite&#45;&gt;update</title>\n<path fill=\"none\" stroke=\"black\" d=\"M54.83,-254C63.79,-254 73.97,-254 83.56,-254\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"83.65,-257.5 93.65,-254 83.65,-250.5 83.65,-257.5\"/>\n</g>\n<!-- doslug -->\n<g id=\"node6\" class=\"node\">\n<title>doslug</title>\n<polygon fill=\"lightblue\" stroke=\"black\" points=\"54.44,-171 0.44,-171 0.44,-135 54.44,-135 54.44,-171\"/>\n<text text-anchor=\"middle\" x=\"27.44\" y=\"-148.8\" font-family=\"Times,serif\" font-size=\"14.00\">doslug</text>\n</g>\n<!-- item -->\n<g id=\"node13\" class=\"node\">\n<title>item</title>\n<polygon fill=\"palegreen\" stroke=\"black\" points=\"147.66,-198 93.66,-198 93.66,-162 147.66,-162 147.66,-198\"/>\n<text text-anchor=\"middle\" x=\"120.66\" y=\"-175.8\" font-family=\"Times,serif\" font-size=\"14.00\">item</text>\n</g>\n<!-- doslug&#45;&gt;item -->\n<g id=\"edge10\" class=\"edge\">\n<title>doslug&#45;&gt;item</title>\n<path fill=\"none\" stroke=\"black\" d=\"M54.83,-160.81C63.89,-163.49 74.19,-166.54 83.87,-169.4\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"83.07,-172.82 93.65,-172.3 85.06,-166.11 83.07,-172.82\"/>\n</g>\n<!-- action -->\n<g id=\"node14\" class=\"node\">\n<title>action</title>\n<polygon fill=\"palegreen\" stroke=\"black\" points=\"147.66,-144 93.66,-144 93.66,-108 147.66,-108 147.66,-144\"/>\n<text text-anchor=\"middle\" x=\"120.66\" y=\"-121.8\" font-family=\"Times,serif\" font-size=\"14.00\">action</text>\n</g>\n<!-- doslug&#45;&gt;action -->\n<g id=\"edge12\" class=\"edge\">\n<title>doslug&#45;&gt;action</title>\n<path fill=\"none\" stroke=\"black\" d=\"M54.83,-145.19C63.89,-142.51 74.19,-139.46 83.87,-136.6\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"85.06,-139.89 93.65,-133.7 83.07,-133.18 85.06,-139.89\"/>\n</g>\n<!-- reschedue -->\n<g id=\"node8\" class=\"node\">\n<title>reschedue</title>\n<polygon fill=\"palegreen\" stroke=\"black\" points=\"258.38,-90 186.46,-90 186.46,-54 258.38,-54 258.38,-90\"/>\n<text text-anchor=\"middle\" x=\"222.42\" y=\"-67.8\" font-family=\"Times,serif\" font-size=\"14.00\">reschedue</text>\n</g>\n<!-- running&#45;&gt;reschedue -->\n<g id=\"edge2\" class=\"edge\">\n<title>running&#45;&gt;reschedue</title>\n<path fill=\"none\" stroke=\"black\" d=\"M150.25,-72C158.36,-72 167.39,-72 176.23,-72\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"176.45,-75.5 186.45,-72 176.45,-68.5 176.45,-75.5\"/>\n</g>\n<!-- ready&#45;&gt;start -->\n<g id=\"edge4\" class=\"edge\">\n<title>ready&#45;&gt;start</title>\n<path fill=\"none\" stroke=\"black\" d=\"M147.87,-18C159.03,-18 172.26,-18 184.39,-18\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"184.69,-21.5 194.69,-18 184.69,-14.5 184.69,-21.5\"/>\n</g>\n<!-- modified -->\n<g id=\"node11\" class=\"node\">\n<title>modified</title>\n<polygon fill=\"palegreen\" stroke=\"black\" points=\"255.47,-292 189.37,-292 189.37,-256 255.47,-256 255.47,-292\"/>\n<text text-anchor=\"middle\" x=\"222.42\" y=\"-269.8\" font-family=\"Times,serif\" font-size=\"14.00\">modified</text>\n</g>\n<!-- update&#45;&gt;modified -->\n<g id=\"edge6\" class=\"edge\">\n<title>update&#45;&gt;modified</title>\n<path fill=\"none\" stroke=\"black\" d=\"M147.87,-259.25C157.5,-261.18 168.65,-263.42 179.32,-265.56\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"178.84,-269.03 189.33,-267.57 180.22,-262.17 178.84,-269.03\"/>\n</g>\n<!-- new -->\n<g id=\"node12\" class=\"node\">\n<title>new</title>\n<polygon fill=\"palegreen\" stroke=\"black\" points=\"249.42,-238 195.42,-238 195.42,-202 249.42,-202 249.42,-238\"/>\n<text text-anchor=\"middle\" x=\"222.42\" y=\"-215.8\" font-family=\"Times,serif\" font-size=\"14.00\">new</text>\n</g>\n<!-- update&#45;&gt;new -->\n<g id=\"edge8\" class=\"edge\">\n<title>update&#45;&gt;new</title>\n<path fill=\"none\" stroke=\"black\" d=\"M147.87,-245.07C159.44,-241.12 173.22,-236.43 185.71,-232.17\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"187.05,-235.41 195.38,-228.87 184.79,-228.79 187.05,-235.41\"/>\n</g>\n<!-- modified&#45;&gt;slugs -->\n<g id=\"edge7\" class=\"edge\">\n<title>modified&#45;&gt;slugs</title>\n<path fill=\"none\" stroke=\"black\" d=\"M255.61,-265.38C265.56,-262.72 276.6,-259.77 286.87,-257.02\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"288.05,-260.32 296.81,-254.36 286.24,-253.56 288.05,-260.32\"/>\n</g>\n<!-- new&#45;&gt;slugs -->\n<g id=\"edge9\" class=\"edge\">\n<title>new&#45;&gt;slugs</title>\n<path fill=\"none\" stroke=\"black\" d=\"M249.66,-227.02C261.08,-230.08 274.67,-233.72 287.11,-237.05\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"286.21,-240.43 296.77,-239.63 288.02,-233.67 286.21,-240.43\"/>\n</g>\n<!-- item&#45;&gt;sites -->\n<g id=\"edge11\" class=\"edge\">\n<title>item&#45;&gt;sites</title>\n<path fill=\"none\" stroke=\"black\" d=\"M147.87,-172.91C159.62,-169.73 173.66,-165.93 186.3,-162.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"187.33,-165.85 196.07,-159.86 185.51,-159.09 187.33,-165.85\"/>\n</g>\n<!-- action&#45;&gt;sites -->\n<g id=\"edge13\" class=\"edge\">\n<title>action&#45;&gt;sites</title>\n<path fill=\"none\" stroke=\"black\" d=\"M147.87,-133.09C159.62,-136.27 173.66,-140.07 186.3,-143.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"185.51,-146.91 196.07,-146.14 187.33,-140.15 185.51,-146.91\"/>\n</g>\n</g>\n</svg>\n"
    },
    {
      "type": "paragraph",
      "id": "b08a5f0fd00c8ab4",
      "text": "We will separate the queues for sites and slugs to be examined. We will preload sites with a few broadly connected sites. Visiting sites will produce slugs, visiting slugs will produce sites."
    },
    {
      "type": "paragraph",
      "id": "f03c5ab2edfcb80d",
      "text": "Aside: a [[slug]] is a page title in lower case with spaces turned to hyphens and other punctuation removed."
    },
    {
      "type": "paragraph",
      "id": "7cdd8f6f00dd279e",
      "text": "We'll single step through dosite pausing after each sitemap fetch reporting availability, activity and errors."
    },
    {
      "type": "paragraph",
      "id": "af5f52325ab6786e",
      "text": "We'll single step through doslug pausing after page fetch reporting new and familiar sites and page format errors."
    },
    {
      "type": "paragraph",
      "id": "205444d1af98a8d8",
      "text": "It makes sense to run either dosite or doslug against their respective queues independently. Both must run to complete a scrape."
    },
    {
      "type": "paragraph",
      "id": "7ec3282fbc1cba49",
      "text": "A scrape will launch with a few seed sites and complete when both queues are empty and no work is in flight. A cron job can be configured to launch scrapes on a regular schedule."
    },
    {
      "type": "paragraph",
      "id": "2e0397bdbafb0de8",
      "text": "See [[How To Deno]]"
    }
  ],
  "journal": [
    {
      "type": "create",
      "item": {
        "title": "Stepping the Async Scrape",
        "story": []
      },
      "date": 1583553560567
    },
    {
      "item": {
        "type": "factory",
        "id": "6fd987059580e844"
      },
      "id": "6fd987059580e844",
      "type": "add",
      "date": 1583553562849
    },
    {
      "type": "edit",
      "id": "6fd987059580e844",
      "item": {
        "type": "paragraph",
        "id": "6fd987059580e844",
        "text": "We've designed a scrape that runs with some parallelism captured with liberal use of async and await. Now we are thinking we can single-step this long running computation but have to think through what that even means."
      },
      "date": 1583553671786
    },
    {
      "type": "add",
      "id": "ba4923c13a056877",
      "item": {
        "type": "paragraph",
        "id": "ba4923c13a056877",
        "text": "See [[Search over the Horizon]]"
      },
      "after": "6fd987059580e844",
      "date": 1583553690578
    },
    {
      "item": {
        "type": "factory",
        "id": "2fd6f6cb4a266876"
      },
      "id": "2fd6f6cb4a266876",
      "type": "add",
      "after": "ba4923c13a056877",
      "date": 1583553701611
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  queue -> fetch -> site -> page -> page -> queue\n}"
      },
      "date": 1583553884571
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  queue -> fetch -> map -> site -> page -> page -> queue\n}"
      },
      "date": 1583554012586
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  start -> scrape"
      },
      "date": 1583554114077
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  start -> scrape -> work\n  work -> doSite\n  work -> doPage\n\n}"
      },
      "date": 1583554179847
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  start -> scrape -> work\n  work -> site\n  work -> slug\n\n}"
      },
      "date": 1583554209755
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  start -> scrape -> work\n  work -> dosite\n  work -> doslug\n\n}"
      },
      "date": 1583554233068
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  start -> scrape -> work\n  work -> dosite\n  work -> doslug\n\n}"
      },
      "date": 1583554336885
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  start -> scrape -> work\n  work -> dosite -> update\n  work -> doslug\n\n}"
      },
      "date": 1583554407522
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  start -> scrape -> work\n  work -> dosite -> update -> modified\n  update -> noew\n  work -> doslug\n\n}"
      },
      "date": 1583554495645
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  start -> scrape -> work\n  work -> dosite -> update -> modified\n  update -> new\n  work -> doslug\n\n}"
      },
      "date": 1583554511902
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  start -> scrape -> work\n  work -> dosite -> update -> modified -> enqueue\n  update -> new -> enqueue -> scrape\n  work -> doslug\n\n}"
      },
      "date": 1583554591985
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  start -> scrape -> work\n  work -> dosite -> update -> modified -> enqueue\n  update -> new -> enqueue -> scrape\n  work -> doslug -> \n\n}"
      },
      "date": 1583554678136
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  start -> scrape -> work\n  work -> dosite -> update -> modified -> enqueue\n  update -> new -> enqueue -> scrape\n  work -> doslug -> item -> enqueue\n  doslug -> action > enqueue\n}\n\n}"
      },
      "date": 1583554748429
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  start -> scrape -> work\n  work -> dosite -> update -> modified -> enqueue\n  update -> new -> enqueue -> scrape\n  work -> doslug -> item -> enqueue\n  doslug -> action -> enqueue\n}\n\n}"
      },
      "date": 1583554763919
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=TB\n  start -> scrape -> work\n  work -> dosite -> update -> modified -> enqueue\n  update -> new -> enqueue -> scrape\n  work -> doslug -> item -> enqueue\n  doslug -> action -> enqueue\n}\n\n}"
      },
      "date": 1583554786112
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=TB\n  start -> scrape -> work\n  clock -> work -> dosite -> update -> modified -> enqueue\n  update -> new -> enqueue -> work\n  work -> doslug -> item -> enqueue\n  doslug -> action -> enqueue\n}\n\n}"
      },
      "date": 1583554867228
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=TB\n  start -> scrape -> work\n  clock -> work -> dosite -> update -> modified -> doslug\n  update -> new -> doslug\n  work -> doslug -> item -> dosite\n  doslug -> action -> dosite\n}\n\n}"
      },
      "date": 1583555642996
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=TB\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  start -> scrape -> work\n  clock -> work -> dosite -> update -> modified -> doslug\n  update -> new -> doslug\n  work -> doslug -> item -> dosite\n  doslug -> action -> dosite\n}\n\n}"
      },
      "date": 1583555755749
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=TB\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> doslug\n  update -> new -> doslug\n  work -> doslug -> item -> dosite\n  doslug -> action -> dosite\n}\n\n}"
      },
      "date": 1583555818685
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=TB\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> doslug\n  update -> new -> doslug\n  doslug -> item -> dosite\n  doslug -> action -> dosite\n}\n\n}"
      },
      "date": 1583555835704
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> doslug\n  update -> new -> doslug\n  doslug -> item -> dosite\n  doslug -> action -> dosite\n}\n\n}"
      },
      "date": 1583555850728
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  queue -> dosite\n  queue -> doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> queue\n  update -> new -> queue\n  doslug -> item -> queue\n  doslug -> action -> queue\n}\n\n}"
      },
      "date": 1583555981195
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  queue -> dosite\n  queue -> doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> newpage -> queue\n  update -> new -> newpage\n  doslug -> item -> newsite -> queue\n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583556050427
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite -> dosite\n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583556159178
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite -> dosite\n  doslug -> action -> newsite\n  doslug -> rest -> newsite\n}\n\n}"
      },
      "date": 1583696171820
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite -> dosite\n  doslug -> action -> newsite\n  doslug -> rest -> dosite\n}\n\n}"
      },
      "date": 1583696318275
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  interest -> dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite -> dosite\n  doslug -> action -> newsite\n  doslug -> interest\n}\n\n}"
      },
      "date": 1583696382280
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  start -> interest -> dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite -> dosite\n  doslug -> action -> newsite\n  doslug -> interest\n}\n\n}"
      },
      "date": 1583696424691
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  start -> interest -> dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite -> dosite\n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583696451367
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=TB\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  start -> interest -> dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite -> dosite\n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583696466879
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  start -> dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite -> dosite\n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583696510185
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  start -> newsite -> dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite -> dosite\n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583696613578
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  start -> newsite -> dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite \n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583696646302
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite -> doslug\n  node [fillcolor=palegreen]\n  start -> newsite -> dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite \n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583697509607
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> newpage -> doslug\n  update -> new -> newpage\n  doslug -> item -> newsite \n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583697656980
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> newpage \n  update -> new -> newpage\n  doslug -> item -> newsite \n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583697740321
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite -> doslug -> dosite [style=dotted]\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> newpage \n  update -> new -> newpage\n  doslug -> item -> newsite \n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583697805212
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite -> doslug [style=dashed]\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> newpage \n  update -> new -> newpage\n  doslug -> item -> newsite \n  doslug -> action -> newsite\n}\n\n}"
      },
      "date": 1583697862261
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite -> doslug [style=dashed]\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> queuepage \n  update -> new -> newpage\n  doslug -> item -> queuesite \n  doslug -> action -> queuesite\n}\n\n}"
      },
      "date": 1583697920139
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite -> doslug [style=dashed]\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> queuepage \n  update -> new -> queuepage\n  doslug -> item -> queuesite \n  doslug -> action -> queuesite\n}\n\n}"
      },
      "date": 1583697950277
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite -> doslug [style=dashed]\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> page \n  update -> new -> page\n  doslug -> item -> site \n  doslug -> action -> site\n}\n\n}"
      },
      "date": 1583698009148
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite -> doslug [style=invisible]\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> page \n  update -> new -> page\n  doslug -> item -> site \n  doslug -> action -> site\n}\n\n}"
      },
      "date": 1583698055353
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  site\n  page\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> page \n  update -> new -> page\n  doslug -> item -> site \n  doslug -> action -> site\n}\n\n}"
      },
      "date": 1583698268645
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  site\n  page\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> pages \n  update -> new -> pages\n  doslug -> item -> sites \n  doslug -> action -> sites\n  start -> sites\n}\n\n}"
      },
      "date": 1583699576440
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  sites\n  pages\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> pages \n  update -> new -> pages\n  doslug -> item -> sites \n  doslug -> action -> sites\n  start -> sites\n}\n\n}"
      },
      "date": 1583699591872
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  start -> sites\n  slugs\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> slugs \n  update -> new -> slugs\n  doslug -> item -> sites \n  doslug -> action -> sites\n  start -> sites\n}\n\n}"
      },
      "date": 1583699646278
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  start -> sites\n  slugs\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> slugs \n  update -> new -> slugs\n  doslug -> item -> sites \n  doslug -> action -> sites\n}\n\n}"
      },
      "date": 1583699685530
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  sites\n  slugs\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dosite -> update -> modified -> slugs \n  update -> new -> slugs\n  doslug -> item -> sites \n  doslug -> action -> sites\n}\n\n}"
      },
      "date": 1583699717570
    },
    {
      "item": {
        "type": "factory",
        "id": "b08a5f0fd00c8ab4"
      },
      "id": "b08a5f0fd00c8ab4",
      "type": "add",
      "after": "2fd6f6cb4a266876",
      "date": 1583699916224
    },
    {
      "type": "edit",
      "id": "b08a5f0fd00c8ab4",
      "item": {
        "type": "paragraph",
        "id": "b08a5f0fd00c8ab4",
        "text": "We will separate the queues of sites and slugs to be examined. We will preload sites with a few broadly connected sites. Visiting sites will produce slugs, visiting slugs will produce sites."
      },
      "date": 1583700207858
    },
    {
      "type": "edit",
      "id": "b08a5f0fd00c8ab4",
      "item": {
        "type": "paragraph",
        "id": "b08a5f0fd00c8ab4",
        "text": "We will separate the queues for sites and slugs to be examined. We will preload sites with a few broadly connected sites. Visiting sites will produce slugs, visiting slugs will produce sites."
      },
      "date": 1583700606572
    },
    {
      "type": "add",
      "id": "7cdd8f6f00dd279e",
      "item": {
        "type": "paragraph",
        "id": "7cdd8f6f00dd279e",
        "text": "We'll single step through dosites pausing after each sitemap fetch reporting availability, activity and sitemap errors."
      },
      "after": "b08a5f0fd00c8ab4",
      "date": 1583700884041
    },
    {
      "type": "edit",
      "id": "7cdd8f6f00dd279e",
      "item": {
        "type": "paragraph",
        "id": "7cdd8f6f00dd279e",
        "text": "We'll single step through dosites pausing after each sitemap fetch reporting availability, activity and errors."
      },
      "date": 1583700890175
    },
    {
      "type": "add",
      "id": "af5f52325ab6786e",
      "item": {
        "type": "paragraph",
        "id": "af5f52325ab6786e",
        "text": "We'll single step through doslug pausing after page fetch reporting new and familiar sites."
      },
      "after": "7cdd8f6f00dd279e",
      "date": 1583701052855
    },
    {
      "type": "edit",
      "id": "7cdd8f6f00dd279e",
      "item": {
        "type": "paragraph",
        "id": "7cdd8f6f00dd279e",
        "text": "We'll single step through dosite pausing after each sitemap fetch reporting availability, activity and errors."
      },
      "date": 1583701059731
    },
    {
      "type": "edit",
      "id": "af5f52325ab6786e",
      "item": {
        "type": "paragraph",
        "id": "af5f52325ab6786e",
        "text": "We'll single step through doslug pausing after page fetch reporting new and familiar sites and page format errors."
      },
      "date": 1583701088531
    },
    {
      "type": "add",
      "id": "205444d1af98a8d8",
      "item": {
        "type": "paragraph",
        "id": "205444d1af98a8d8",
        "text": "It makes sense to run either dosite or doslug against their respective queues independently. A scrape will launch with a few seed sites and complete when both queues are empty and no work is in flight. A cron job can be configured to launch scrapes on a regular schedule."
      },
      "after": "af5f52325ab6786e",
      "date": 1583702259282
    },
    {
      "type": "edit",
      "id": "205444d1af98a8d8",
      "item": {
        "type": "paragraph",
        "id": "205444d1af98a8d8",
        "text": "It makes sense to run either dosite or doslug against their respective queues independently."
      },
      "date": 1583702272299
    },
    {
      "type": "add",
      "id": "7ec3282fbc1cba49",
      "item": {
        "type": "paragraph",
        "id": "7ec3282fbc1cba49",
        "text": "A scrape will launch with a few seed sites and complete when both queues are empty and no work is in flight. A cron job can be configured to launch scrapes on a regular schedule."
      },
      "after": "205444d1af98a8d8",
      "date": 1583702274158
    },
    {
      "type": "edit",
      "id": "205444d1af98a8d8",
      "item": {
        "type": "paragraph",
        "id": "205444d1af98a8d8",
        "text": "It makes sense to run either dosite or doslug against their respective queues independently. Both must run to complete a scrape."
      },
      "date": 1583702340977
    },
    {
      "type": "add",
      "id": "f03c5ab2edfcb80d",
      "item": {
        "type": "paragraph",
        "id": "f03c5ab2edfcb80d",
        "text": "Aside: a slug is a page title in lower case with spaces turned to hyphens and other punctuation removed."
      },
      "after": "b08a5f0fd00c8ab4",
      "date": 1583800147803
    },
    {
      "type": "add",
      "id": "2e0397bdbafb0de8",
      "item": {
        "type": "paragraph",
        "id": "2e0397bdbafb0de8",
        "text": "See [[How To Deno]]"
      },
      "after": "7ec3282fbc1cba49",
      "date": 1584227899599
    },
    {
      "type": "edit",
      "id": "2fd6f6cb4a266876",
      "item": {
        "type": "graphviz",
        "id": "2fd6f6cb4a266876",
        "text": "digraph {\n  start\n  sites\n  slugs\n  node [shape=box style=filled fillcolor=lightblue]\n  rankdir=LR\n  dotime\n  dosite\n  doslug\n  node [fillcolor=palegreen]\n  dotime -> running -> reschedue\n  dotime -> ready -> start\n  dosite -> update -> modified -> slugs \n  update -> new -> slugs\n  doslug -> item -> sites \n  doslug -> action -> sites\n}\n\n}"
      },
      "date": 1590187244245
    },
    {
      "type": "fork",
      "site": "ward.asia.wiki.org",
      "date": 1626504614938
    },
    {
      "type": "edit",
      "id": "f03c5ab2edfcb80d",
      "item": {
        "type": "paragraph",
        "id": "f03c5ab2edfcb80d",
        "text": "Aside: a [[slug]] is a page title in lower case with spaces turned to hyphens and other punctuation removed."
      },
      "date": 1626504771389
    }
  ]
}