{
  "title": "Closest Points on Ellipses",
  "story": [
    {
      "type": "paragraph",
      "id": "17d726d886f8e531",
      "text": "Interactive visualization of closest points on ellipses [https://github.com/thi-ng/umbrella/tree/develop/examples/ellipse-proximity#ellipse-proximity github], [https://github.com/thi-ng/umbrella/blob/8ab2cbfe2f59b7ef672b6e1cf2a43368f8437ddf/packages/rdom/README.md#usage-examples github]"
    },
    {
      "type": "code",
      "id": "49cbc9e1e10bd3a7",
      "text": "import { closestPointEllipse } from \"https://cdn.skypack.dev/@thi.ng/geom-closest-point\";\nimport { $compile } from \"https://cdn.skypack.dev/@thi.ng/rdom\";\nimport { $canvas } from \"https://cdn.skypack.dev/@thi.ng/rdom-canvas\";\nimport { merge, reactive } from \"https://cdn.skypack.dev/@thi.ng/rstream\";\nimport { gestureStream } from \"https://cdn.skypack.dev/@thi.ng/rstream-gestures\";\nimport { mapcat, repeatedly } from \"https://cdn.skypack.dev/@thi.ng/transducers\";\nimport { add2, normalCCW, random2 } from \"https://cdn.skypack.dev/@thi.ng/vectors\";\n"
    },
    {
      "type": "frame",
      "id": "5396a0b4e33715c0",
      "text": "//wiki.ralfbarkow.ch/assets/pages/js-snippet-template/importjs.html\nHEIGHT 256"
    },
    {
      "type": "code",
      "id": "6e15ffd2751a2b1e",
      "text": "const W = 600;\n// define random ellipses ([origin, radius] tuples)\nconst ELLIPSES = [\n    ...repeatedly(() => [random2([], 50, W - 50), random2([], 10, W / 2)], 5),\n];\n"
    },
    {
      "type": "paragraph",
      "id": "f73048d74de4e1b1",
      "text": "Compile & mount [[Reactive Canvas]] component:\n"
    },
    {
      "type": "code",
      "id": "a328b59029ece579",
      "text": "$compile($canvas(\n// stream merge\nmerge({\n    src: [\n        // #1 initial call to action...\n        reactive([\n            \"g\",\n            {},\n            [\n                \"text\",\n                { align: \"center\", fill: \"black\" },\n                [W / 2, W / 2],\n                \"Move your mouse / finger!\",\n            ],\n        ]),\n        // #2 stream of mouse/touch coordinates (main)\n        gestureStream(document.body).map((e) => [\n            \"g\",\n            // disable canvas clearing if no mouse buttons pressed\n            { fill: \"none\", __clear: !!e.buttons },\n            // semi-transparent white rect to fade previous frame\n            [\"rect\", { fill: [1, 1, 1, 0.2] }, [0, 0], W, W],\n            // declare ellipses, closest points and tangents\n            ...mapcat(([o, r]) => {\n                const p = closestPointEllipse(e.pos, o, r);\n                return [\n                    [\"ellipse\", { stroke: \"#ccc\" }, o, r],\n                    [\"circle\", { stroke: \"#f0f\" }, p, 5],\n                    [\"line\", { stroke: \"#666\" }, e.pos, p],\n                    [\n                        \"line\",\n                        { stroke: \"#6c0\" },\n                        p,\n                        add2(null, normalCCW([], p, e.pos, 100), p),\n                    ],\n                ];\n            }, ELLIPSES),\n        ]),\n    ],\n}), [W, W])).mount(document.getElementById(\"output\"));"
    },
    {
      "type": "paragraph",
      "id": "bdf54d76a84ff46a",
      "text": "Note: The id property has been changed from \"app\" to \"output\"."
    }
  ],
  "journal": [
    {
      "type": "create",
      "item": {
        "title": "Closest Points on Ellipses",
        "story": []
      },
      "date": 1678809155895
    },
    {
      "id": "17d726d886f8e531",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "17d726d886f8e531",
        "text": "Interactive visualization of [[Closest Points on Ellipses]] [https://github.com/thi-ng/umbrella/tree/develop/examples/ellipse-proximity#ellipse-proximity github], [https://github.com/thi-ng/umbrella/blob/8ab2cbfe2f59b7ef672b6e1cf2a43368f8437ddf/packages/rdom/README.md#usage-examples github]"
      },
      "attribution": {
        "page": "ellipse-proximity"
      },
      "date": 1678809163075
    },
    {
      "id": "49cbc9e1e10bd3a7",
      "type": "add",
      "item": {
        "type": "code",
        "id": "49cbc9e1e10bd3a7",
        "text": "import { closestPointEllipse } from \"https://cdn.skypack.dev/@thi.ng/geom-closest-point\";\nimport { $compile } from \"https://cdn.skypack.dev/@thi.ng/rdom\";\nimport { $canvas } from \"https://cdn.skypack.dev/@thi.ng/rdom-canvas\";\nimport { merge, reactive } from \"https://cdn.skypack.dev/@thi.ng/rstream\";\nimport { gestureStream } from \"https://cdn.skypack.dev/@thi.ng/rstream-gestures\";\nimport { mapcat, repeatedly } from \"https://cdn.skypack.dev/@thi.ng/transducers\";\nimport { add2, normalCCW, random2 } from \"https://cdn.skypack.dev/@thi.ng/vectors\";\n"
      },
      "after": "17d726d886f8e531",
      "attribution": {
        "page": "ellipse-proximity"
      },
      "date": 1678809165673
    },
    {
      "id": "fa1561eadf808a62",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "fa1561eadf808a62",
        "text": "Wiki [[JavaScript]] Snippet Runner: [â‡’ [[Static Import Snippet]]]"
      },
      "after": "49cbc9e1e10bd3a7",
      "attribution": {
        "page": "ellipse-proximity"
      },
      "date": 1678809168502
    },
    {
      "id": "5396a0b4e33715c0",
      "type": "add",
      "item": {
        "type": "frame",
        "id": "5396a0b4e33715c0",
        "text": "//wiki.ralfbarkow.ch/assets/pages/js-snippet-template/importjs.html\nHEIGHT 256"
      },
      "after": "fa1561eadf808a62",
      "attribution": {
        "page": "ellipse-proximity"
      },
      "date": 1678809171086
    },
    {
      "id": "6e15ffd2751a2b1e",
      "type": "add",
      "item": {
        "type": "code",
        "id": "6e15ffd2751a2b1e",
        "text": "const W = 600;\n// define random ellipses ([origin, radius] tuples)\nconst ELLIPSES = [\n    ...repeatedly(() => [random2([], 50, W - 50), random2([], 10, W / 2)], 5),\n];\n"
      },
      "after": "5396a0b4e33715c0",
      "attribution": {
        "page": "ellipse-proximity"
      },
      "date": 1678809174589
    },
    {
      "id": "f73048d74de4e1b1",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "f73048d74de4e1b1",
        "text": "Compile & mount reactive canvas component:\n"
      },
      "after": "6e15ffd2751a2b1e",
      "attribution": {
        "page": "ellipse-proximity"
      },
      "date": 1678809176881
    },
    {
      "id": "a328b59029ece579",
      "type": "add",
      "item": {
        "type": "code",
        "id": "a328b59029ece579",
        "text": "$compile($canvas(\n// stream merge\nmerge({\n    src: [\n        // #1 initial call to action...\n        reactive([\n            \"g\",\n            {},\n            [\n                \"text\",\n                { align: \"center\", fill: \"black\" },\n                [W / 2, W / 2],\n                \"Move your mouse / finger!\",\n            ],\n        ]),\n        // #2 stream of mouse/touch coordinates (main)\n        gestureStream(document.body).map((e) => [\n            \"g\",\n            // disable canvas clearing if no mouse buttons pressed\n            { fill: \"none\", __clear: !!e.buttons },\n            // semi-transparent white rect to fade previous frame\n            [\"rect\", { fill: [1, 1, 1, 0.2] }, [0, 0], W, W],\n            // declare ellipses, closest points and tangents\n            ...mapcat(([o, r]) => {\n                const p = closestPointEllipse(e.pos, o, r);\n                return [\n                    [\"ellipse\", { stroke: \"#ccc\" }, o, r],\n                    [\"circle\", { stroke: \"#f0f\" }, p, 5],\n                    [\"line\", { stroke: \"#666\" }, e.pos, p],\n                    [\n                        \"line\",\n                        { stroke: \"#6c0\" },\n                        p,\n                        add2(null, normalCCW([], p, e.pos, 100), p),\n                    ],\n                ];\n            }, ELLIPSES),\n        ]),\n    ],\n}), [W, W])).mount(document.getElementById(\"output\"));"
      },
      "after": "6e15ffd2751a2b1e",
      "attribution": {
        "page": "ellipse-proximity"
      },
      "date": 1678809222313
    },
    {
      "id": "f73048d74de4e1b1",
      "type": "move",
      "order": [
        "17d726d886f8e531",
        "49cbc9e1e10bd3a7",
        "fa1561eadf808a62",
        "5396a0b4e33715c0",
        "6e15ffd2751a2b1e",
        "f73048d74de4e1b1",
        "a328b59029ece579"
      ],
      "date": 1678809227535
    },
    {
      "id": "bdf54d76a84ff46a",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "bdf54d76a84ff46a",
        "text": "Note: The id property has been changed from \"app\" to \"output\"."
      },
      "after": "a328b59029ece579",
      "attribution": {
        "page": "ellipse-proximity"
      },
      "date": 1678809231417
    },
    {
      "type": "edit",
      "id": "17d726d886f8e531",
      "item": {
        "type": "paragraph",
        "id": "17d726d886f8e531",
        "text": "Interactive visualization of closest points on ellipses [https://github.com/thi-ng/umbrella/tree/develop/examples/ellipse-proximity#ellipse-proximity github], [https://github.com/thi-ng/umbrella/blob/8ab2cbfe2f59b7ef672b6e1cf2a43368f8437ddf/packages/rdom/README.md#usage-examples github]"
      },
      "date": 1678809272693
    },
    {
      "type": "edit",
      "id": "f73048d74de4e1b1",
      "item": {
        "type": "paragraph",
        "id": "f73048d74de4e1b1",
        "text": "Compile & mount [[Reactive Canvas]] component:\n"
      },
      "date": 1678810052423
    },
    {
      "id": "fa1561eadf808a62",
      "type": "remove",
      "removedTo": {
        "page": "@thi.ng/rdom"
      },
      "date": 1678816188929
    }
  ]
}