{
  "title": "Yoghurt-Pot Telephone",
  "story": [
    {
      "type": "paragraph",
      "id": "23b541a30c1bf71b",
      "text": "We think of message channels as a Yoghurt-pot Telephone® [http://images.scholastic.co.uk/assets/a/7b/9a/activity-sheets-victorians-2-578219.pdf pdf]."
    },
    {
      "type": "code",
      "id": "bf092c15d898067c",
      "text": "const yoghurt_phone = new MessageChannel();"
    },
    {
      "type": "markdown",
      "id": "4d704b8c3ee74469",
      "text": "      ––––––                        –––––\n    po(r)t1 |~~~~~~~~~~~~~~~~~~~~~~~| po(r)t2\n       –––––                         –––––\n"
    },
    {
      "type": "paragraph",
      "id": "f2057f34d30fa703",
      "text": "See \"Using MessageChannel() bidirectionally for multiple messages between page and iframe\" [https://stackoverflow.com/questions/51201120/using-messagechannel-bidirectionally-for-multiple-messages-between-page-and-if stackoverflow]"
    },
    {
      "type": "pagefold",
      "id": "5c455f5f1e1d9842",
      "text": "~"
    },
    {
      "type": "markdown",
      "id": "5ec88c22b45b3122",
      "text": "# Application Frame"
    },
    {
      "type": "frame",
      "id": "960b673df56e6706",
      "text": "//wiki.ralfbarkow.ch/assets/pages/yoghurt-pot-telephone/esm-page2.html\nHEIGHT 444"
    },
    {
      "type": "markdown",
      "id": "f0ed55ef4638a759",
      "text": "**Note**: The application frame contains `esm-page2.html`, which is based on the [[ESM Snippet Template]] but modified to include `page2.html` as an iframe (a frame within a frame). See assets folder below. See also [[Message Queue]]"
    },
    {
      "type": "pagefold",
      "id": "5c455f5f1e1d9842",
      "text": "~"
    },
    {
      "type": "code",
      "id": "eaf169087e6b4cb1",
      "text": "let mains_yoghurt_pot;\n\nconst list = document.querySelector('ul'); // This is the parent page's message queue"
    },
    {
      "type": "code",
      "id": "d5aa0881fd8fcb08",
      "text": "const frame = document.getElementById('iframe-page2');"
    },
    {
      "type": "paragraph",
      "id": "edf6a70739c0e647",
      "text": "From the frame, receive the po(r)t and keep it tight."
    },
    {
      "type": "code",
      "id": "2cfc152f02fdd21c",
      "text": "frame.addEventListener(\"load\", iframeLoaded, false);"
    },
    {
      "type": "paragraph",
      "id": "746cc6554d69155f",
      "text": "Keep one of the po(r)t and give the other one to the other user (iframe)."
    },
    {
      "type": "code",
      "id": "ed2f9be341d3caa5",
      "text": "function iframeLoaded() {    \n      mains_yoghurt_pot = yoghurt_phone.port1; // we keep the first port for ourselve\n      mains_yoghurt_pot.onmessage = frameTalksToMe; // we listen for messages from 'frame'\n      // we give the other port to 'frame'\n      frame.contentWindow.postMessage(\"establish message channel\", '*', [yoghurt_phone.port2]);      \n    }"
    },
    {
      "type": "paragraph",
      "id": "94bc60aabadab41b",
      "text": "Note: We use the WindowObject.postMessage method, which is not the same as the one we'll use to communicate through the MessagePorts. "
    },
    {
      "type": "code",
      "id": "5313d01fe55aa8d6",
      "text": "function frameTalksToMe(e){\n      console.log(\"Parent got data: \");\n      console.log(e.data)\n      \n      let guid = e.data.guid;\n      let message = e.data.message;\n\n      let listItem = document.createElement('li');\n      listItem.setAttribute(\"id\", guid);\n      listItem.textContent = guid;\n      list.appendChild(listItem);\n\n      //fake an async response\n      setTimeout(()=>{ \n        respondToIFrame({guid, message}) \n        var listItem = document.getElementById(guid);\n        listItem.parentNode.removeChild(listItem);\n        }, Math.random() * 3000)     \n    }"
    },
    {
      "type": "code",
      "id": "e943daaac6db802e",
      "text": "function respondToIFrame(response){\n      console.log(\"Parent responding to iframe\");\n      mains_yoghurt_pot.postMessage(response); // we talk inside our own port\n    }"
    },
    {
      "type": "markdown",
      "id": "942c3de528b0f30b",
      "text": "# Assets"
    },
    {
      "type": "assets",
      "id": "300edca408b1a4ba",
      "text": "pages/yoghurt-pot-telephone"
    },
    {
      "type": "paragraph",
      "id": "137b94b171c16ab8",
      "text": "Note: page2.html is from the [[Bi-Directional Multimessage Message Channel Demo]] and [https://plnkr.co/edit/VirVuU9oRXMB7OhC?preview plnkr]."
    },
    {
      "type": "paragraph",
      "id": "7e90b0c1f6b38591",
      "text": "See also [[Channel Messaging Basic]]"
    }
  ],
  "journal": [
    {
      "type": "create",
      "item": {
        "title": "Yoghurt-Pot Telephone",
        "story": []
      },
      "date": 1711371138357
    },
    {
      "item": {
        "type": "factory",
        "id": "23b541a30c1bf71b"
      },
      "id": "23b541a30c1bf71b",
      "type": "add",
      "date": 1711371157377
    },
    {
      "type": "edit",
      "id": "23b541a30c1bf71b",
      "item": {
        "type": "paragraph",
        "id": "23b541a30c1bf71b",
        "text": "We think of message channels as a Yoghurt-pot Telephone® [pdf]. "
      },
      "date": 1711371169808
    },
    {
      "type": "edit",
      "id": "23b541a30c1bf71b",
      "item": {
        "type": "paragraph",
        "id": "23b541a30c1bf71b",
        "text": "We think of message channels as a Yoghurt-pot Telephone® [http://images.scholastic.co.uk/assets/a/7b/9a/activity-sheets-victorians-2-578219.pdf pdf]. "
      },
      "date": 1711371178880
    },
    {
      "type": "edit",
      "id": "23b541a30c1bf71b",
      "item": {
        "type": "paragraph",
        "id": "23b541a30c1bf71b",
        "text": "We think of message channels as a Yoghurt-pot Telephone® [http://images.scholastic.co.uk/assets/a/7b/9a/activity-sheets-victorians-2-578219.pdf pdf]."
      },
      "date": 1711371210865
    },
    {
      "type": "add",
      "id": "c13b3728c269f068",
      "item": {
        "type": "paragraph",
        "id": "c13b3728c269f068",
        "text": "Generate The Yoghurt-pot telephone® a.k.a MessageChannel. "
      },
      "after": "23b541a30c1bf71b",
      "date": 1711371211554
    },
    {
      "item": {
        "type": "factory",
        "id": "c05893f09032a831"
      },
      "id": "c05893f09032a831",
      "type": "add",
      "after": "c13b3728c269f068",
      "date": 1711371223202
    },
    {
      "type": "edit",
      "id": "c05893f09032a831",
      "item": {
        "type": "code",
        "id": "c05893f09032a831",
        "text": "var yoghurt_phone = new MessageChannel();"
      },
      "date": 1711371225609
    },
    {
      "item": {
        "type": "factory",
        "id": "960b673df56e6706"
      },
      "id": "960b673df56e6706",
      "type": "add",
      "after": "c05893f09032a831",
      "date": 1711371281308
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//localhost:3000/assets/pages/js-snippet-template/importjs.html\nHEIGHT 400"
      },
      "date": 1711371292891
    },
    {
      "id": "960b673df56e6706",
      "type": "move",
      "order": [
        "23b541a30c1bf71b",
        "960b673df56e6706",
        "c13b3728c269f068",
        "c05893f09032a831"
      ],
      "date": 1711371298684
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//localhost:3000/assets/pages/js-snippet-template/importjs.html"
      },
      "date": 1711371314139
    },
    {
      "type": "add",
      "id": "5ec88c22b45b3122",
      "item": {
        "type": "paragraph",
        "id": "5ec88c22b45b3122",
        "text": "Frame from "
      },
      "after": "23b541a30c1bf71b",
      "date": 1711371331759
    },
    {
      "type": "edit",
      "id": "5ec88c22b45b3122",
      "item": {
        "type": "paragraph",
        "id": "5ec88c22b45b3122",
        "text": "Frame from [[JS Snippet Template]]"
      },
      "date": 1711371354786
    },
    {
      "type": "edit",
      "id": "5ec88c22b45b3122",
      "item": {
        "type": "paragraph",
        "id": "5ec88c22b45b3122",
        "text": "Frame"
      },
      "date": 1711371364069
    },
    {
      "type": "add",
      "id": "f0ed55ef4638a759",
      "item": {
        "type": "paragraph",
        "id": "f0ed55ef4638a759",
        "text": "from [[JS Snippet Template]]"
      },
      "after": "5ec88c22b45b3122",
      "date": 1711371365945
    },
    {
      "type": "edit",
      "id": "5ec88c22b45b3122",
      "item": {
        "type": "paragraph",
        "id": "5ec88c22b45b3122",
        "text": "# Frame"
      },
      "date": 1711371369453
    },
    {
      "id": "f0ed55ef4638a759",
      "type": "move",
      "order": [
        "23b541a30c1bf71b",
        "5ec88c22b45b3122",
        "960b673df56e6706",
        "f0ed55ef4638a759",
        "c13b3728c269f068",
        "c05893f09032a831"
      ],
      "date": 1711371372565
    },
    {
      "type": "edit",
      "id": "5ec88c22b45b3122",
      "item": {
        "type": "markdown",
        "id": "5ec88c22b45b3122",
        "text": "# Frame"
      },
      "date": 1711371375072
    },
    {
      "item": {
        "type": "factory",
        "id": "eaf169087e6b4cb1"
      },
      "id": "eaf169087e6b4cb1",
      "type": "add",
      "after": "c05893f09032a831",
      "date": 1711371394968
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "mains_yoghurt_pot = yoghurt_phone.port1;\nframe.contentWindow.postMessage( // this is like a physical meeting\n  'look I made a cool Yoghurt-phone', // some useless message\n  '*', // show your id?\n  [yoghurt_phone.port2] // TRANSFER the po(r)t\n); "
      },
      "date": 1711371396879
    },
    {
      "item": {
        "type": "factory",
        "id": "6d7d43abc49c61ff"
      },
      "id": "6d7d43abc49c61ff",
      "type": "add",
      "after": "eaf169087e6b4cb1",
      "date": 1711371414064
    },
    {
      "type": "edit",
      "id": "6d7d43abc49c61ff",
      "item": {
        "type": "code",
        "id": "6d7d43abc49c61ff",
        "text": "window.onmessage = function physicalMeeting(evt) {\n  if(evt.ports && evt.ports.length) { // only if we have been given a po(r)t\n    frames_yoghurt_pot = evt.ports[0];\n    // ...\n}"
      },
      "date": 1711371417308
    },
    {
      "item": {
        "type": "factory",
        "id": "fe05d930270dd0cc"
      },
      "id": "fe05d930270dd0cc",
      "type": "add",
      "after": "6d7d43abc49c61ff",
      "date": 1711371441384
    },
    {
      "type": "edit",
      "id": "fe05d930270dd0cc",
      "item": {
        "type": "code",
        "id": "fe05d930270dd0cc",
        "text": "// from main doc\nmains_yoghurt_pot.onmessage = frameTalksToMe;"
      },
      "date": 1711371443586
    },
    {
      "id": "c8b5f7b578d6d96e",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "c8b5f7b578d6d96e",
        "text": "Keep one of the po(r)t and give the other one to the other user (iframe). To do this, we use the WindowObject.postMessage method, which is not the same as the one we'll use to communicate through the MessagePorts. "
      },
      "after": "c05893f09032a831",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711371478362
    },
    {
      "id": "edf6a70739c0e647",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "edf6a70739c0e647",
        "text": "\n\nFrom the frame, receive the po(r)t and keep it tight."
      },
      "after": "eaf169087e6b4cb1",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711371499645
    },
    {
      "type": "edit",
      "id": "edf6a70739c0e647",
      "item": {
        "type": "paragraph",
        "id": "edf6a70739c0e647",
        "text": "From the frame, receive the po(r)t and keep it tight."
      },
      "date": 1711371504041
    },
    {
      "id": "5b31ebd35da7189c",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "5b31ebd35da7189c",
        "text": "From now on, each user has its own po(r)t, and only a single po(r)t. So at both ends, you need to setup listeners on their own single po(r)t."
      },
      "after": "6d7d43abc49c61ff",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711371523137
    },
    {
      "item": {
        "type": "factory",
        "id": "009a5ad116989bb1"
      },
      "id": "009a5ad116989bb1",
      "type": "add",
      "after": "fe05d930270dd0cc",
      "date": 1711371546038
    },
    {
      "type": "edit",
      "id": "009a5ad116989bb1",
      "item": {
        "type": "code",
        "id": "009a5ad116989bb1",
        "text": "// from iframe doc\nframes_yoghurt_pot.onmessage = mainTalksToMe;"
      },
      "date": 1711371548919
    },
    {
      "item": {
        "type": "factory",
        "id": "f9d0a59c23237946"
      },
      "id": "f9d0a59c23237946",
      "type": "add",
      "after": "009a5ad116989bb1",
      "date": 1711371557851
    },
    {
      "type": "edit",
      "id": "f9d0a59c23237946",
      "item": {
        "type": "paragraph",
        "id": "f9d0a59c23237946",
        "text": "And then when one of the two users wants to tell something to the other one, they'll do from their own po(r)t."
      },
      "date": 1711371559553
    },
    {
      "item": {
        "type": "factory",
        "id": "4762b69460308594"
      },
      "id": "4762b69460308594",
      "type": "add",
      "after": "f9d0a59c23237946",
      "date": 1711371566428
    },
    {
      "type": "edit",
      "id": "4762b69460308594",
      "item": {
        "type": "code",
        "id": "4762b69460308594",
        "text": "// from main doc\nmains_yoghurt_pot.postMessage('hello frame');"
      },
      "date": 1711371570961
    },
    {
      "item": {
        "type": "code",
        "id": "df09076fdbfa55e7",
        "text": "// or from iframe doc\nframes_yoghurt_pot.postMessage('hello main');\n"
      },
      "id": "df09076fdbfa55e7",
      "type": "add",
      "after": "4762b69460308594",
      "date": 1711371579207
    },
    {
      "type": "fork",
      "date": 1711371596522
    },
    {
      "type": "edit",
      "id": "df09076fdbfa55e7",
      "item": {
        "type": "code",
        "id": "df09076fdbfa55e7",
        "text": "// or from iframe doc\nframes_yoghurt_pot.postMessage('hello main');\n"
      },
      "date": 1711371599206
    },
    {
      "type": "edit",
      "id": "6d7d43abc49c61ff",
      "item": {
        "type": "code",
        "id": "6d7d43abc49c61ff",
        "text": "window.onmessage = function physicalMeeting(evt) {\n  if(evt.ports && evt.ports.length) { // only if we have been given a po(r)t\n    frames_yoghurt_pot = evt.ports[0];\n    // ...\n}"
      },
      "date": 1711371639199,
      "error": {
        "type": "error",
        "msg": ""
      }
    },
    {
      "type": "fork",
      "date": 1711371653510
    },
    {
      "type": "edit",
      "id": "6d7d43abc49c61ff",
      "item": {
        "type": "code",
        "id": "6d7d43abc49c61ff",
        "text": "window.onmessage = function physicalMeeting(evt) {\n  if(evt.ports && evt.ports.length) { // only if we have been given a po(r)t\n    frames_yoghurt_pot = evt.ports[0];\n    // ...\n}}"
      },
      "date": 1711371676932
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "var mains_yoghurt_pot = yoghurt_phone.port1;\nframe.contentWindow.postMessage( // this is like a physical meeting\n  'look I made a cool Yoghurt-phone', // some useless message\n  '*', // show your id?\n  [yoghurt_phone.port2] // TRANSFER the po(r)t\n); "
      },
      "date": 1711371713750
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "var mains_yoghurt_pot = yoghurt_phone.port1;"
      },
      "date": 1711371774331
    },
    {
      "type": "fork",
      "site": "localhost:3000",
      "date": 1711372165102
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//wiki.ralfbarkow.ch/assets/pages/snippet-template/esm.html"
      },
      "date": 1711372203397
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//wiki.dbbs.co/assets/pages/js-snippet-template/esm.html\nHEIGHT 400"
      },
      "date": 1711372253450
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//frame.wiki.dbbs.co/assets/pages/snippet-template/basicjs.html\nHEIGHT 400"
      },
      "date": 1711372285851
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//wiki.ralfbarkow.ch/assets/pages/snippet-template/esm.html"
      },
      "date": 1711372382732
    },
    {
      "type": "fork",
      "date": 1711372479148
    },
    {
      "type": "edit",
      "id": "f0ed55ef4638a759",
      "item": {
        "type": "paragraph",
        "id": "f0ed55ef4638a759",
        "text": "from [[ESM Snippet Template]]"
      },
      "date": 1711372490197
    },
    {
      "id": "f2057f34d30fa703",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "f2057f34d30fa703",
        "text": "See \"Using MessageChannel() bidirectionally for multiple messages between page and iframe\" [https://stackoverflow.com/questions/51201120/using-messagechannel-bidirectionally-for-multiple-messages-between-page-and-if stackoverflow] and \"An Introduction to HTML5 Web Messaging\" [https://dev.opera.com/articles/window-postmessage-messagechannel/ page]"
      },
      "after": "23b541a30c1bf71b",
      "attribution": {
        "page": "Playground",
        "site": "localhost:3000"
      },
      "date": 1711372767819
    },
    {
      "type": "edit",
      "id": "f2057f34d30fa703",
      "item": {
        "type": "paragraph",
        "id": "f2057f34d30fa703",
        "text": "See \"Using MessageChannel() bidirectionally for multiple messages between page and iframe\" [https://stackoverflow.com/questions/51201120/using-messagechannel-bidirectionally-for-multiple-messages-between-page-and-if stackoverflow]"
      },
      "date": 1711372844600
    },
    {
      "type": "fork",
      "date": 1711372971936,
      "error": {
        "type": "error",
        "msg": ""
      }
    },
    {
      "type": "fork",
      "date": 1711372998492
    },
    {
      "id": "5c455f5f1e1d9842",
      "type": "add",
      "item": {
        "type": "pagefold",
        "id": "5c455f5f1e1d9842",
        "text": "~"
      },
      "after": "f2057f34d30fa703",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711373056309
    },
    {
      "id": "5c455f5f1e1d9842",
      "type": "add",
      "item": {
        "type": "pagefold",
        "id": "5c455f5f1e1d9842",
        "text": "~"
      },
      "after": "f0ed55ef4638a759",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711373062626
    },
    {
      "type": "edit",
      "id": "fe05d930270dd0cc",
      "item": {
        "type": "code",
        "id": "fe05d930270dd0cc",
        "text": "// from main doc\n//mains_yoghurt_pot.onmessage = frameTalksToMe;"
      },
      "date": 1711373219904
    },
    {
      "type": "fork",
      "date": 1711373632589
    },
    {
      "type": "edit",
      "id": "942c3de528b0f30b",
      "item": {
        "type": "markdown",
        "id": "942c3de528b0f30b",
        "text": "# Assets"
      },
      "date": 1711373639790
    },
    {
      "item": {
        "type": "factory",
        "id": "300edca408b1a4ba"
      },
      "id": "300edca408b1a4ba",
      "type": "add",
      "after": "942c3de528b0f30b",
      "date": 1711373641478
    },
    {
      "type": "edit",
      "id": "300edca408b1a4ba",
      "item": {
        "type": "assets",
        "id": "300edca408b1a4ba",
        "text": "pages/"
      },
      "date": 1711373648478
    },
    {
      "type": "edit",
      "id": "300edca408b1a4ba",
      "item": {
        "type": "assets",
        "id": "300edca408b1a4ba",
        "text": "pages/yoghurt-pot-telephone"
      },
      "date": 1711373660690
    },
    {
      "type": "fork",
      "site": "wiki.ralfbarkow.ch",
      "date": 1711373710083
    },
    {
      "item": {
        "type": "factory",
        "id": "42a97e8edd9d0245"
      },
      "id": "42a97e8edd9d0245",
      "type": "add",
      "after": "300edca408b1a4ba",
      "date": 1711373850387
    },
    {
      "type": "edit",
      "id": "42a97e8edd9d0245",
      "item": {
        "type": "frame",
        "id": "42a97e8edd9d0245",
        "text": "http://localhost:3000/assets/pages/yoghurt-pot-telephone/page2.html"
      },
      "date": 1711373853262
    },
    {
      "item": {
        "type": "factory",
        "id": "0c7f661495dc3b67"
      },
      "id": "0c7f661495dc3b67",
      "type": "add",
      "after": "42a97e8edd9d0245",
      "date": 1711373959439
    },
    {
      "id": "0c7f661495dc3b67",
      "type": "move",
      "order": [
        "23b541a30c1bf71b",
        "f2057f34d30fa703",
        "5c455f5f1e1d9842",
        "5ec88c22b45b3122",
        "960b673df56e6706",
        "f0ed55ef4638a759",
        "5c455f5f1e1d9842",
        "c13b3728c269f068",
        "c05893f09032a831",
        "c8b5f7b578d6d96e",
        "eaf169087e6b4cb1",
        "edf6a70739c0e647",
        "6d7d43abc49c61ff",
        "5b31ebd35da7189c",
        "fe05d930270dd0cc",
        "009a5ad116989bb1",
        "f9d0a59c23237946",
        "4762b69460308594",
        "df09076fdbfa55e7",
        "942c3de528b0f30b",
        "300edca408b1a4ba",
        "0c7f661495dc3b67",
        "42a97e8edd9d0245"
      ],
      "date": 1711373961981
    },
    {
      "type": "edit",
      "id": "0c7f661495dc3b67",
      "item": {
        "type": "paragraph",
        "id": "0c7f661495dc3b67",
        "text": "# Frame (page2.html)"
      },
      "date": 1711373979914
    },
    {
      "type": "edit",
      "id": "0c7f661495dc3b67",
      "item": {
        "type": "markdown",
        "id": "0c7f661495dc3b67",
        "text": "# Frame (page2.html)"
      },
      "date": 1711373981103
    },
    {
      "type": "edit",
      "id": "fe05d930270dd0cc",
      "item": {
        "type": "code",
        "id": "fe05d930270dd0cc",
        "text": "// from main doc\nmains_yoghurt_pot.onmessage = frameTalksToMe;"
      },
      "date": 1711374034733
    },
    {
      "type": "edit",
      "id": "fe05d930270dd0cc",
      "item": {
        "type": "code",
        "id": "fe05d930270dd0cc",
        "text": "// from main doc\n//mains_yoghurt_pot.onmessage = frameTalksToMe;"
      },
      "date": 1711374257976
    },
    {
      "type": "edit",
      "id": "009a5ad116989bb1",
      "item": {
        "type": "code",
        "id": "009a5ad116989bb1",
        "text": "// from iframe doc\n//frames_yoghurt_pot.onmessage = mainTalksToMe;"
      },
      "date": 1711374263075
    },
    {
      "type": "edit",
      "id": "4762b69460308594",
      "item": {
        "type": "code",
        "id": "4762b69460308594",
        "text": "// from main doc\n//mains_yoghurt_pot.postMessage('hello frame');"
      },
      "date": 1711374266749
    },
    {
      "type": "edit",
      "id": "df09076fdbfa55e7",
      "item": {
        "type": "code",
        "id": "df09076fdbfa55e7",
        "text": "// or from iframe doc\n//frames_yoghurt_pot.postMessage('hello main');\n"
      },
      "date": 1711374269864
    },
    {
      "id": "d5aa0881fd8fcb08",
      "type": "add",
      "item": {
        "type": "code",
        "id": "d5aa0881fd8fcb08",
        "text": "frame.contentWindow.postMessage( // this is like a physical meeting\n  'look I made a cool Yoghurt-phone', // some useless message\n  '*', // show your id?\n  [yoghurt_phone.port2] // TRANSFER the po(r)t\n); "
      },
      "after": "eaf169087e6b4cb1",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711374498880
    },
    {
      "type": "edit",
      "id": "42a97e8edd9d0245",
      "item": {
        "type": "frame",
        "id": "42a97e8edd9d0245",
        "text": "// from iframe doc\n  var frames_yoghurt_pot.onmessage = mainTalksToMe;"
      },
      "date": 1711374712413
    },
    {
      "type": "edit",
      "id": "42a97e8edd9d0245",
      "item": {
        "type": "frame",
        "id": "42a97e8edd9d0245",
        "text": "http://localhost:3000/assets/pages/yoghurt-pot-telephone/index.html"
      },
      "date": 1711374725962
    },
    {
      "type": "edit",
      "id": "0c7f661495dc3b67",
      "item": {
        "type": "markdown",
        "id": "0c7f661495dc3b67",
        "text": "# Frame (index.html)"
      },
      "date": 1711374736811
    },
    {
      "type": "edit",
      "id": "d5aa0881fd8fcb08",
      "item": {
        "type": "code",
        "id": "d5aa0881fd8fcb08",
        "text": "const frame = \nframe.contentWindow.postMessage( // this is like a physical meeting\n  'look I made a cool Yoghurt-phone', // some useless message\n  '*', // show your id?\n  [yoghurt_phone.port2] // TRANSFER the po(r)t\n); "
      },
      "date": 1711374829679
    },
    {
      "type": "edit",
      "id": "d5aa0881fd8fcb08",
      "item": {
        "type": "code",
        "id": "d5aa0881fd8fcb08",
        "text": "const frame = document.getElementById('iframe-page2');\nframe.contentWindow.postMessage( // this is like a physical meeting\n  'look I made a cool Yoghurt-phone', // some useless message\n  '*', // show your id?\n  [yoghurt_phone.port2] // TRANSFER the po(r)t\n); "
      },
      "date": 1711374904147
    },
    {
      "type": "edit",
      "id": "d5aa0881fd8fcb08",
      "item": {
        "type": "code",
        "id": "d5aa0881fd8fcb08",
        "text": "const frame = document.getElementById('iframe-page2);\nframe.contentWindow.postMessage( // this is like a physical meeting\n  'look I made a cool Yoghurt-phone', // some useless message\n  '*', // show your id?\n  [yoghurt_phone.port2] // TRANSFER the po(r)t\n); "
      },
      "date": 1711374924864
    },
    {
      "item": {
        "type": "factory",
        "id": "7e90b0c1f6b38591"
      },
      "id": "7e90b0c1f6b38591",
      "type": "add",
      "after": "42a97e8edd9d0245",
      "date": 1711374935382
    },
    {
      "type": "edit",
      "id": "7e90b0c1f6b38591",
      "item": {
        "type": "paragraph",
        "id": "7e90b0c1f6b38591",
        "text": "See also [[Channel Messaging Basic]]"
      },
      "date": 1711374941045
    },
    {
      "type": "edit",
      "id": "d5aa0881fd8fcb08",
      "item": {
        "type": "code",
        "id": "d5aa0881fd8fcb08",
        "text": "const frame = document.getElementById('iframe-page2');\nframe.contentWindow.postMessage( // this is like a physical meeting\n  'look I made a cool Yoghurt-phone', // some useless message\n  '*', // show your id?\n  [yoghurt_phone.port2] // TRANSFER the po(r)t\n); "
      },
      "date": 1711374977578
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//localhost:3000/assets/pages/snippet-template/esm.html"
      },
      "date": 1711375179083
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//localhost:3000/assets/pages/yoghurt-pot-telephone/esm%2Bp2.html"
      },
      "date": 1711375371134
    },
    {
      "item": {
        "type": "factory",
        "id": "137b94b171c16ab8"
      },
      "id": "137b94b171c16ab8",
      "type": "add",
      "after": "7e90b0c1f6b38591",
      "date": 1711375546286
    },
    {
      "type": "edit",
      "id": "137b94b171c16ab8",
      "item": {
        "type": "paragraph",
        "id": "137b94b171c16ab8",
        "text": "Note: page2.html is from the [[Bi-directional multimessage message channel demo]]."
      },
      "date": 1711375569565
    },
    {
      "type": "edit",
      "id": "137b94b171c16ab8",
      "item": {
        "type": "paragraph",
        "id": "137b94b171c16ab8",
        "text": "Note: page2.html is from the \"Bi-directional multimessage message channel demo\" [[Playground]]."
      },
      "date": 1711375620979
    },
    {
      "type": "remove",
      "id": "42a97e8edd9d0245",
      "date": 1711375702987
    },
    {
      "type": "remove",
      "id": "0c7f661495dc3b67",
      "date": 1711375705108
    },
    {
      "id": "ed2f9be341d3caa5",
      "type": "add",
      "item": {
        "type": "code",
        "id": "ed2f9be341d3caa5",
        "text": "  function iframeLoaded() {  \n      var channel = new MessageChannel();   \n      port_to_frame = channel.port1; // we keep the first port for ourselve\n      port_to_frame.onmessage = requestFromIFrame; // we listen for messages from 'ifr'\n      // we give the other port to 'ifr'\n      ifr.contentWindow.postMessage(\"establish message channel\", '*', [channel.port2]);      \n    }"
      },
      "after": "df09076fdbfa55e7",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711376082407
    },
    {
      "id": "2cfc152f02fdd21c",
      "type": "add",
      "item": {
        "type": "code",
        "id": "2cfc152f02fdd21c",
        "text": "frame.addEventListener(\"load\", iframeLoaded, false);"
      },
      "after": "df09076fdbfa55e7",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711376108156
    },
    {
      "type": "remove",
      "id": "6d7d43abc49c61ff",
      "date": 1711376155481
    },
    {
      "id": "2cfc152f02fdd21c",
      "type": "move",
      "order": [
        "23b541a30c1bf71b",
        "f2057f34d30fa703",
        "5c455f5f1e1d9842",
        "5ec88c22b45b3122",
        "960b673df56e6706",
        "f0ed55ef4638a759",
        "5c455f5f1e1d9842",
        "c13b3728c269f068",
        "c05893f09032a831",
        "c8b5f7b578d6d96e",
        "eaf169087e6b4cb1",
        "d5aa0881fd8fcb08",
        "edf6a70739c0e647",
        "2cfc152f02fdd21c",
        "5b31ebd35da7189c",
        "fe05d930270dd0cc",
        "009a5ad116989bb1",
        "f9d0a59c23237946",
        "4762b69460308594",
        "df09076fdbfa55e7",
        "ed2f9be341d3caa5",
        "942c3de528b0f30b",
        "300edca408b1a4ba",
        "7e90b0c1f6b38591",
        "137b94b171c16ab8"
      ],
      "date": 1711376168115
    },
    {
      "id": "ed2f9be341d3caa5",
      "type": "move",
      "order": [
        "23b541a30c1bf71b",
        "f2057f34d30fa703",
        "5c455f5f1e1d9842",
        "5ec88c22b45b3122",
        "960b673df56e6706",
        "f0ed55ef4638a759",
        "5c455f5f1e1d9842",
        "c13b3728c269f068",
        "c05893f09032a831",
        "c8b5f7b578d6d96e",
        "eaf169087e6b4cb1",
        "d5aa0881fd8fcb08",
        "edf6a70739c0e647",
        "2cfc152f02fdd21c",
        "ed2f9be341d3caa5",
        "5b31ebd35da7189c",
        "fe05d930270dd0cc",
        "009a5ad116989bb1",
        "f9d0a59c23237946",
        "4762b69460308594",
        "df09076fdbfa55e7",
        "942c3de528b0f30b",
        "300edca408b1a4ba",
        "7e90b0c1f6b38591",
        "137b94b171c16ab8"
      ],
      "date": 1711376171892
    },
    {
      "type": "edit",
      "id": "ed2f9be341d3caa5",
      "item": {
        "type": "code",
        "id": "ed2f9be341d3caa5",
        "text": "  function iframeLoaded() {  \n      var channel = new MessageChannel();   \n      port_to_frame = channel.port1; // we keep the first port for ourselve\n      port_to_frame.onmessage = requestFromIFrame; // we listen for messages from 'ifr'\n      // we give the other port to 'ifr'\n      frame.contentWindow.postMessage(\"establish message channel\", '*', [channel.port2]);      \n    }"
      },
      "date": 1711376180152
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "var mains_yoghurt_pot = yoghurt_phone.port1;\nlet port_to_frame;"
      },
      "date": 1711376301504
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "var mains_yoghurt_pot = yoghurt_phone.port1;\nlet port_to_frame;\nlet requestFromIFrame;"
      },
      "date": 1711376364411,
      "error": {
        "type": "error",
        "msg": ""
      }
    },
    {
      "type": "fork",
      "date": 1711376387396
    },
    {
      "id": "5313d01fe55aa8d6",
      "type": "add",
      "item": {
        "type": "code",
        "id": "5313d01fe55aa8d6",
        "text": "function requestFromIFrame(e){\n      console.log(\"Parent got data: \");\n      console.log(e.data)\n      \n      let guid = e.data.guid;\n      let message = e.data.message;\n\n      let listItem = document.createElement('li');\n      listItem.setAttribute(\"id\", guid);\n      listItem.textContent = guid;\n      list.appendChild(listItem);\n\n      //fake an async response\n      setTimeout(()=>{ \n        respondToIFrame({guid, message}) \n        var listItem = document.getElementById(guid);\n        listItem.parentNode.removeChild(listItem);\n        }, Math.random() * 3000)     \n    }"
      },
      "after": "df09076fdbfa55e7",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711376630410
    },
    {
      "id": "e943daaac6db802e",
      "type": "add",
      "item": {
        "type": "code",
        "id": "e943daaac6db802e",
        "text": "function respondToIFrame(response){\n      console.log(\"Parent responding to iframe\");\n      port_to_frame.postMessage(response); // we talk inside our own port\n    }"
      },
      "after": "5313d01fe55aa8d6",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711376647518
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "var mains_yoghurt_pot = yoghurt_phone.port1;\nlet port_to_frame;\n//let requestFromIFrame;"
      },
      "date": 1711376730654
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "var mains_yoghurt_pot = yoghurt_phone.port1;\nlet port_to_frame;\n//let requestFromIFrame;\n var list = document.querySelector('ul');"
      },
      "date": 1711376788611
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//localhost:3000/assets/pages/yoghurt-pot-telephone/esm%2Bp2.html\nHEIGTH 666"
      },
      "date": 1711376934975
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//localhost:3000/assets/pages/yoghurt-pot-telephone/esm%2Bp2.html\nHEIGHT 666"
      },
      "date": 1711376962542
    },
    {
      "type": "edit",
      "id": "c05893f09032a831",
      "item": {
        "type": "code",
        "id": "c05893f09032a831",
        "text": "const yoghurt_phone = new MessageChannel();"
      },
      "date": 1711377015960
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "const mains_yoghurt_pot = yoghurt_phone.port1;\nlet port_to_frame;\n//let requestFromIFrame;\nconst list = document.querySelector('ul');"
      },
      "date": 1711377027940
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "let port_to_frame;\n//let requestFromIFrame;\nconst list = document.querySelector('ul');"
      },
      "date": 1711377134716
    },
    {
      "type": "remove",
      "id": "c05893f09032a831",
      "date": 1711377238045
    },
    {
      "type": "remove",
      "id": "c13b3728c269f068",
      "date": 1711377246223
    },
    {
      "type": "remove",
      "id": "c8b5f7b578d6d96e",
      "date": 1711377249174
    },
    {
      "type": "edit",
      "id": "ed2f9be341d3caa5",
      "item": {
        "type": "code",
        "id": "ed2f9be341d3caa5",
        "text": "  function iframeLoaded() {  \n      var channel = new MessageChannel();   \n      port_to_frame = channel.port1; // we keep the first port for ourselve\n      port_to_frame.onmessage = requestFromIFrame; // we listen for messages from 'frame'\n      // we give the other port to 'frame'\n      frame.contentWindow.postMessage(\"establish message channel\", '*', [channel.port2]);      \n    }"
      },
      "date": 1711377291243
    },
    {
      "type": "remove",
      "id": "5b31ebd35da7189c",
      "date": 1711377315816
    },
    {
      "type": "remove",
      "id": "fe05d930270dd0cc",
      "date": 1711377318015
    },
    {
      "type": "remove",
      "id": "009a5ad116989bb1",
      "date": 1711377319701
    },
    {
      "type": "remove",
      "id": "f9d0a59c23237946",
      "date": 1711377327455
    },
    {
      "type": "remove",
      "id": "4762b69460308594",
      "date": 1711377329196
    },
    {
      "type": "remove",
      "id": "df09076fdbfa55e7",
      "date": 1711377331258
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "const yoghurt_phone = new MessageChannel();\nlet port_to_frame;\n//let requestFromIFrame;\nconst list = document.querySelector('ul');"
      },
      "date": 1711377449750
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//localhost:3000/assets/pages/yoghurt-pot-telephone/esm-page2.html\nHEIGHT 666"
      },
      "date": 1711377748037
    },
    {
      "type": "edit",
      "id": "ed2f9be341d3caa5",
      "item": {
        "type": "code",
        "id": "ed2f9be341d3caa5",
        "text": "  function iframeLoaded() {  \n      //var channel = new MessageChannel();   \n      port_to_frame = channel.port1; // we keep the first port for ourselve\n      port_to_frame.onmessage = requestFromIFrame; // we listen for messages from 'frame'\n      // we give the other port to 'frame'\n      frame.contentWindow.postMessage(\"establish message channel\", '*', [channel.port2]);      \n    }"
      },
      "date": 1711377843202
    },
    {
      "type": "edit",
      "id": "d5aa0881fd8fcb08",
      "item": {
        "type": "code",
        "id": "d5aa0881fd8fcb08",
        "text": "const frame = document.getElementById('iframe-page2');"
      },
      "date": 1711377863260
    },
    {
      "type": "edit",
      "id": "ed2f9be341d3caa5",
      "item": {
        "type": "code",
        "id": "ed2f9be341d3caa5",
        "text": "  function iframeLoaded() {  \n      //var channel = new MessageChannel();   \n      port_to_frame = yoghurt_phone.port1; // we keep the first port for ourselve\n      port_to_frame.onmessage = requestFromIFrame; // we listen for messages from 'frame'\n      // we give the other port to 'frame'\n      frame.contentWindow.postMessage(\"establish message channel\", '*', [yoghurt_phone.port2]);      \n    }"
      },
      "date": 1711377893487
    },
    {
      "type": "fork",
      "site": "localhost:3000",
      "date": 1711378098810
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "http://wiki.ralfbarkow.ch/assets/pages/yoghurt-pot-telephone/esm-page2.html\nHEIGHT 666"
      },
      "date": 1711378127036
    },
    {
      "type": "edit",
      "id": "5ec88c22b45b3122",
      "item": {
        "type": "markdown",
        "id": "5ec88c22b45b3122",
        "text": "# Frame (esm with page2)"
      },
      "date": 1711378136516
    },
    {
      "type": "edit",
      "id": "5ec88c22b45b3122",
      "item": {
        "type": "markdown",
        "id": "5ec88c22b45b3122",
        "text": "# Frame (esm with page2.html)"
      },
      "date": 1711378149650
    },
    {
      "type": "edit",
      "id": "f0ed55ef4638a759",
      "item": {
        "type": "paragraph",
        "id": "f0ed55ef4638a759",
        "text": "based on [[ESM Snippet Template]] and assets folder below"
      },
      "date": 1711378228395
    },
    {
      "type": "edit",
      "id": "f0ed55ef4638a759",
      "item": {
        "type": "paragraph",
        "id": "f0ed55ef4638a759",
        "text": "**Note**: `esm-page2.html` is based on [[ESM Snippet Template]] but modified to include `page2.html`as iframe. See assets folder below."
      },
      "date": 1711378303233
    },
    {
      "type": "edit",
      "id": "f0ed55ef4638a759",
      "item": {
        "type": "markdown",
        "id": "f0ed55ef4638a759",
        "text": "**Note**: `esm-page2.html` is based on [[ESM Snippet Template]] but modified to include `page2.html`as iframe. See assets folder below."
      },
      "date": 1711378304475
    },
    {
      "type": "edit",
      "id": "5ec88c22b45b3122",
      "item": {
        "type": "markdown",
        "id": "5ec88c22b45b3122",
        "text": "# Frame (esm-page2.html)"
      },
      "date": 1711378318117
    },
    {
      "type": "edit",
      "id": "f0ed55ef4638a759",
      "item": {
        "type": "markdown",
        "id": "f0ed55ef4638a759",
        "text": "**Note**: `esm-page2.html` is based on the [[ESM Snippet Template]] but modified to include `page2.html`as iframe. See assets folder below."
      },
      "date": 1711378338610
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "const yoghurt_phone = new MessageChannel();\nlet port_to_frame;\n//let requestFromIFrame;\nconst list = document.querySelector('ul'); // This is the parent page's message queue"
      },
      "date": 1711378575662
    },
    {
      "type": "edit",
      "id": "f0ed55ef4638a759",
      "item": {
        "type": "markdown",
        "id": "f0ed55ef4638a759",
        "text": "**Note**: `esm-page2.html` is based on the [[ESM Snippet Template]] but modified to include `page2.html`as an iframe. See assets folder below."
      },
      "date": 1711378758722
    },
    {
      "type": "edit",
      "id": "137b94b171c16ab8",
      "item": {
        "type": "paragraph",
        "id": "137b94b171c16ab8",
        "text": "Note: page2.html is from the \"Bi-directional multimessage message channel demo\" [[Playground]] and [https://plnkr.co/edit/VirVuU9oRXMB7OhC?preview plnkr]."
      },
      "date": 1711379136771
    },
    {
      "type": "edit",
      "id": "ed2f9be341d3caa5",
      "item": {
        "type": "code",
        "id": "ed2f9be341d3caa5",
        "text": "function iframeLoaded() {  \n      //var channel = new MessageChannel();   \n      port_to_frame = yoghurt_phone.port1; // we keep the first port for ourselve\n      port_to_frame.onmessage = requestFromIFrame; // we listen for messages from 'frame'\n      // we give the other port to 'frame'\n      frame.contentWindow.postMessage(\"establish message channel\", '*', [yoghurt_phone.port2]);      \n    }"
      },
      "date": 1711379239948
    },
    {
      "type": "edit",
      "id": "ed2f9be341d3caa5",
      "item": {
        "type": "code",
        "id": "ed2f9be341d3caa5",
        "text": "function iframeLoaded() {    \n      port_to_frame = yoghurt_phone.port1; // we keep the first port for ourselve\n      port_to_frame.onmessage = requestFromIFrame; // we listen for messages from 'frame'\n      // we give the other port to 'frame'\n      frame.contentWindow.postMessage(\"establish message channel\", '*', [yoghurt_phone.port2]);      \n    }"
      },
      "date": 1711379267868
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//wiki.ralfbarkow.ch/assets/pages/yoghurt-pot-telephone/esm-page2.html\nHEIGHT 666"
      },
      "date": 1711379452004
    },
    {
      "type": "fork",
      "site": "wiki.ralfbarkow.ch",
      "date": 1711381827155
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "\nlet port_to_frame;\n//let requestFromIFrame;\nconst list = document.querySelector('ul'); // This is the parent page's message queue"
      },
      "date": 1711381827156
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "let port_to_frame;\n//let requestFromIFrame;\nconst list = document.querySelector('ul'); // This is the parent page's message queue"
      },
      "date": 1711381835234
    },
    {
      "id": "bf092c15d898067c",
      "type": "add",
      "item": {
        "type": "code",
        "id": "bf092c15d898067c",
        "text": "const yoghurt_phone = new MessageChannel();"
      },
      "after": "23b541a30c1bf71b",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711381840441
    },
    {
      "type": "edit",
      "id": "5ec88c22b45b3122",
      "item": {
        "type": "markdown",
        "id": "5ec88c22b45b3122",
        "text": "# Application Frame (esm-page2.html)"
      },
      "date": 1711381930828
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//localhost:3000/assets/pages/yoghurt-pot-telephone/esm-page2.html\nHEIGHT 666"
      },
      "date": 1711382014543
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//localhost:3000/assets/pages/yoghurt-pot-telephone/esm-page2.html\nHEIGHT 555"
      },
      "date": 1711382170177
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//localhost:3000/assets/pages/yoghurt-pot-telephone/esm-page2.html\nHEIGHT 444"
      },
      "date": 1711382176632
    },
    {
      "type": "edit",
      "id": "5ec88c22b45b3122",
      "item": {
        "type": "markdown",
        "id": "5ec88c22b45b3122",
        "text": "# Application Frame"
      },
      "date": 1711382321272
    },
    {
      "type": "edit",
      "id": "f0ed55ef4638a759",
      "item": {
        "type": "markdown",
        "id": "f0ed55ef4638a759",
        "text": "**Note**: The application frame contains `esm-page2.html`, which is based on the [[ESM Snippet Template]] but modified to include `page2.html` as an iframe. See assets folder below."
      },
      "date": 1711382347119
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "let mains_yoghurt_pot;\n//let requestFromIFrame;\nconst list = document.querySelector('ul'); // This is the parent page's message queue"
      },
      "date": 1711382587787
    },
    {
      "type": "edit",
      "id": "ed2f9be341d3caa5",
      "item": {
        "type": "code",
        "id": "ed2f9be341d3caa5",
        "text": "function iframeLoaded() {    \n      mains_yoghurt_pot = yoghurt_phone.port1; // we keep the first port for ourselve\n      mains_yoghurt_pot.onmessage = requestFromIFrame; // we listen for messages from 'frame'\n      // we give the other port to 'frame'\n      frame.contentWindow.postMessage(\"establish message channel\", '*', [yoghurt_phone.port2]);      \n    }"
      },
      "date": 1711382607302
    },
    {
      "type": "edit",
      "id": "ed2f9be341d3caa5",
      "item": {
        "type": "code",
        "id": "ed2f9be341d3caa5",
        "text": "function iframeLoaded() {    \n      mains_yoghurt_pot = yoghurt_phone.port1; // we keep the first port for ourselve\n      mains_yoghurt_pot.onmessage = frameTalksToMe; // we listen for messages from 'frame'\n      // we give the other port to 'frame'\n      frame.contentWindow.postMessage(\"establish message channel\", '*', [yoghurt_phone.port2]);      \n    }"
      },
      "date": 1711382628616
    },
    {
      "type": "edit",
      "id": "5313d01fe55aa8d6",
      "item": {
        "type": "code",
        "id": "5313d01fe55aa8d6",
        "text": "function frameTalksToMe(e){\n      console.log(\"Parent got data: \");\n      console.log(e.data)\n      \n      let guid = e.data.guid;\n      let message = e.data.message;\n\n      let listItem = document.createElement('li');\n      listItem.setAttribute(\"id\", guid);\n      listItem.textContent = guid;\n      list.appendChild(listItem);\n\n      //fake an async response\n      setTimeout(()=>{ \n        respondToIFrame({guid, message}) \n        var listItem = document.getElementById(guid);\n        listItem.parentNode.removeChild(listItem);\n        }, Math.random() * 3000)     \n    }"
      },
      "date": 1711382649380
    },
    {
      "type": "edit",
      "id": "e943daaac6db802e",
      "item": {
        "type": "code",
        "id": "e943daaac6db802e",
        "text": "function respondToIFrame(response){\n      console.log(\"Parent responding to iframe\");\n      mains_yoghurt_pot.postMessage(response); // we talk inside our own port\n    }"
      },
      "date": 1711382755038
    },
    {
      "type": "edit",
      "id": "e943daaac6db802e",
      "item": {
        "type": "code",
        "id": "e943daaac6db802e",
        "text": "function respondToIFrame(response){\n      console.log(\"Parent responding to iframe\");\n      mains_yoghurt_pot.postMessage(response); // we talk inside our own port\n    }"
      },
      "date": 1711382789016,
      "error": {
        "type": "error",
        "msg": ""
      }
    },
    {
      "type": "fork",
      "date": 1711382822955
    },
    {
      "type": "fork",
      "date": 1711382827387
    },
    {
      "id": "4d704b8c3ee74469",
      "type": "add",
      "item": {
        "type": "markdown",
        "id": "4d704b8c3ee74469",
        "text": "      ––––––                        –––––\n    po(r)t1 |~~~~~~~~~~~~~~~~~~~~~~~| po(r)t2\n       –––––                         –––––\n"
      },
      "after": "bf092c15d898067c",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711384374028
    },
    {
      "id": "94bc60aabadab41b",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "94bc60aabadab41b",
        "text": "We use the WindowObject.postMessage method, which is not the same as the one we'll use to communicate through the MessagePorts. "
      },
      "after": "ed2f9be341d3caa5",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711384534912
    },
    {
      "type": "edit",
      "id": "94bc60aabadab41b",
      "item": {
        "type": "paragraph",
        "id": "94bc60aabadab41b",
        "text": "Note: We use the WindowObject.postMessage method, which is not the same as the one we'll use to communicate through the MessagePorts. "
      },
      "date": 1711384562151
    },
    {
      "id": "746cc6554d69155f",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "746cc6554d69155f",
        "text": "Keep one of the po(r)t and give the other one to the other user (iframe)."
      },
      "after": "2cfc152f02fdd21c",
      "attribution": {
        "page": "scratch"
      },
      "date": 1711384675297
    },
    {
      "type": "edit",
      "id": "f0ed55ef4638a759",
      "item": {
        "type": "markdown",
        "id": "f0ed55ef4638a759",
        "text": "**Note**: The application frame contains `esm-page2.html`, which is based on the [[ESM Snippet Template]] but modified to include `page2.html` as an iframe. See assets folder below. See also [[Message Queue]]"
      },
      "date": 1711405059868
    },
    {
      "type": "edit",
      "id": "137b94b171c16ab8",
      "item": {
        "type": "paragraph",
        "id": "137b94b171c16ab8",
        "text": "Note: page2.html is from the [[Bi-Directional Multimessage Message Channel Demo]] and [https://plnkr.co/edit/VirVuU9oRXMB7OhC?preview plnkr]."
      },
      "date": 1711430732022
    },
    {
      "type": "edit",
      "id": "eaf169087e6b4cb1",
      "item": {
        "type": "code",
        "id": "eaf169087e6b4cb1",
        "text": "let mains_yoghurt_pot;\n\nconst list = document.querySelector('ul'); // This is the parent page's message queue"
      },
      "date": 1711430785992
    },
    {
      "type": "fork",
      "site": "localhost:3000",
      "date": 1711430813911
    },
    {
      "type": "edit",
      "id": "960b673df56e6706",
      "item": {
        "type": "frame",
        "id": "960b673df56e6706",
        "text": "//wiki.ralfbarkow.ch/assets/pages/yoghurt-pot-telephone/esm-page2.html\nHEIGHT 444"
      },
      "date": 1711430820413
    },
    {
      "id": "7e90b0c1f6b38591",
      "type": "move",
      "order": [
        "23b541a30c1bf71b",
        "bf092c15d898067c",
        "4d704b8c3ee74469",
        "f2057f34d30fa703",
        "5c455f5f1e1d9842",
        "5ec88c22b45b3122",
        "960b673df56e6706",
        "f0ed55ef4638a759",
        "5c455f5f1e1d9842",
        "eaf169087e6b4cb1",
        "d5aa0881fd8fcb08",
        "edf6a70739c0e647",
        "2cfc152f02fdd21c",
        "746cc6554d69155f",
        "ed2f9be341d3caa5",
        "94bc60aabadab41b",
        "5313d01fe55aa8d6",
        "e943daaac6db802e",
        "942c3de528b0f30b",
        "300edca408b1a4ba",
        "137b94b171c16ab8",
        "7e90b0c1f6b38591"
      ],
      "date": 1711436639627
    },
    {
      "type": "edit",
      "id": "f0ed55ef4638a759",
      "item": {
        "type": "markdown",
        "id": "f0ed55ef4638a759",
        "text": "**Note**: The application frame contains `esm-page2.html`, which is based on the [[ESM Snippet Template]] but modified to include `page2.html` as an iframe (a frame within a frame). See assets folder below. See also [[Message Queue]]"
      },
      "date": 1711583709210
    }
  ]
}