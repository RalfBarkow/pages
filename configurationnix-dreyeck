{
  "title": "configuration.nix @dreyeck",
  "story": [
    {
      "type": "code",
      "id": "42938d64ed613e86",
      "text": "\n  imports =\n    [ # Include the results of the hardware scan.\n      ./hardware-configuration.nix\n      #./bind.nix\n      ./fossil.nix\n      ./wiki.nix\n      #./nginx-fossil.nix\n      ./nginx-wiki.nix\n      #./lamdera.nix\n    ]; \n"
    },
    {
      "type": "paragraph",
      "id": "9065ec3ed86fbd88",
      "text": "nginx-wiki.nix – services.nginx "
    },
    {
      "type": "paragraph",
      "id": "4eeb0c0ebd9d9e60",
      "text": "wiki.nix –  systemd.services.wiki [⇒ [[Systemd Hardening]]] ⇒ [[elm-pages.service]]"
    }
  ],
  "journal": [
    {
      "type": "create",
      "item": {
        "title": "configuration.nix @dreyeck",
        "story": []
      },
      "date": 1693994908875
    },
    {
      "item": {
        "type": "factory",
        "id": "42938d64ed613e86"
      },
      "id": "42938d64ed613e86",
      "type": "add",
      "date": 1693994910437
    },
    {
      "type": "edit",
      "id": "42938d64ed613e86",
      "item": {
        "type": "code",
        "id": "42938d64ed613e86",
        "text": "{\n  imports =\n    [ # Include the results of the hardware scan.\n      ./hardware-configuration.nix\n      #./bind.nix\n      ./fossil.nix\n      ./wiki.nix\n      #./nginx-fossil.nix\n      ./nginx-wiki.nix\n      #./lamdera.nix\n    ]; …\n"
      },
      "date": 1693994921159
    },
    {
      "type": "edit",
      "id": "42938d64ed613e86",
      "item": {
        "type": "code",
        "id": "42938d64ed613e86",
        "text": "\n  imports =\n    [ # Include the results of the hardware scan.\n      ./hardware-configuration.nix\n      #./bind.nix\n      ./fossil.nix\n      ./wiki.nix\n      #./nginx-fossil.nix\n      ./nginx-wiki.nix\n      #./lamdera.nix\n    ]; \n"
      },
      "date": 1693994934425
    },
    {
      "item": {
        "type": "factory",
        "id": "4eeb0c0ebd9d9e60"
      },
      "id": "4eeb0c0ebd9d9e60",
      "type": "add",
      "after": "42938d64ed613e86",
      "date": 1693994972103
    },
    {
      "type": "edit",
      "id": "4eeb0c0ebd9d9e60",
      "item": {
        "type": "paragraph",
        "id": "4eeb0c0ebd9d9e60",
        "text": "wiki.nix –  systemd.services.wiki "
      },
      "date": 1693994979152
    },
    {
      "type": "edit",
      "id": "4eeb0c0ebd9d9e60",
      "item": {
        "type": "paragraph",
        "id": "4eeb0c0ebd9d9e60",
        "text": "wiki.nix –  systemd.services.wiki"
      },
      "date": 1693995020011
    },
    {
      "type": "add",
      "id": "9065ec3ed86fbd88",
      "item": {
        "type": "paragraph",
        "id": "9065ec3ed86fbd88",
        "text": "nginx-wiki.nix – "
      },
      "after": "4eeb0c0ebd9d9e60",
      "date": 1693995027158
    },
    {
      "type": "edit",
      "id": "9065ec3ed86fbd88",
      "item": {
        "type": "paragraph",
        "id": "9065ec3ed86fbd88",
        "text": "nginx-wiki.nix – services.nginx "
      },
      "date": 1693995033420
    },
    {
      "item": {
        "type": "factory",
        "id": "bc21d42d7118eeef"
      },
      "id": "bc21d42d7118eeef",
      "type": "add",
      "after": "9065ec3ed86fbd88",
      "date": 1693995134330
    },
    {
      "type": "edit",
      "id": "bc21d42d7118eeef",
      "item": {
        "type": "pagefold",
        "id": "bc21d42d7118eeef",
        "text": "~"
      },
      "date": 1693995137368
    },
    {
      "item": {
        "type": "factory",
        "id": "cbfbebfef9a7bcd1"
      },
      "id": "cbfbebfef9a7bcd1",
      "type": "add",
      "after": "bc21d42d7118eeef",
      "date": 1693995139348
    },
    {
      "type": "edit",
      "id": "cbfbebfef9a7bcd1",
      "item": {
        "type": "paragraph",
        "id": "cbfbebfef9a7bcd1",
        "text": "Systemd Hardening"
      },
      "date": 1693995141496
    },
    {
      "type": "edit",
      "id": "cbfbebfef9a7bcd1",
      "item": {
        "type": "paragraph",
        "id": "cbfbebfef9a7bcd1",
        "text": "Systemd Hardening [https://nixos.wiki/wiki/Systemd_Hardening page]"
      },
      "date": 1693995148211
    },
    {
      "type": "edit",
      "id": "cbfbebfef9a7bcd1",
      "item": {
        "type": "paragraph",
        "id": "cbfbebfef9a7bcd1",
        "text": "⇒ [[Systemd Hardening]]. [https://nixos.wiki/wiki/Systemd_Hardening page]"
      },
      "date": 1693995244431
    },
    {
      "id": "90ecc08458ac00e4",
      "type": "add",
      "item": {
        "type": "paragraph",
        "id": "90ecc08458ac00e4",
        "text": "How to configure Systemd service unit to start Node app with \"npm start\" instead of \"app.js\" [https://serverfault.com/questions/1018676/how-to-configure-systemd-service-unit-to-start-node-app-with-npm-start-instead page]"
      },
      "after": "cbfbebfef9a7bcd1",
      "attribution": {
        "page": "2023-09-06"
      },
      "date": 1693995483010
    },
    {
      "id": "f840a62e1a48e5bb",
      "type": "add",
      "item": {
        "type": "code",
        "id": "f840a62e1a48e5bb",
        "text": "...\n\n[Service]\nEnvironment=NODE_PORT=3000\nType=simple\nUser=www-data\nRestart=on-failure\nWorkingDirectory=/var/www/<your-code-directory>\nExecStart=npm start\n\n..."
      },
      "after": "bc21d42d7118eeef",
      "attribution": {
        "page": "2023-09-06"
      },
      "date": 1693995489265
    },
    {
      "id": "f840a62e1a48e5bb",
      "type": "move",
      "order": [
        "42938d64ed613e86",
        "4eeb0c0ebd9d9e60",
        "9065ec3ed86fbd88",
        "bc21d42d7118eeef",
        "cbfbebfef9a7bcd1",
        "90ecc08458ac00e4",
        "f840a62e1a48e5bb"
      ],
      "date": 1693995494619
    },
    {
      "item": {
        "type": "factory",
        "id": "939f3c8060e3028c"
      },
      "id": "939f3c8060e3028c",
      "type": "add",
      "after": "f840a62e1a48e5bb",
      "date": 1693995510188
    },
    {
      "type": "edit",
      "id": "939f3c8060e3028c",
      "item": {
        "type": "paragraph",
        "id": "939f3c8060e3028c",
        "text": "How to create a systemd service template in NixOS?"
      },
      "date": 1693995512574
    },
    {
      "type": "edit",
      "id": "939f3c8060e3028c",
      "item": {
        "type": "paragraph",
        "id": "939f3c8060e3028c",
        "text": "How to create a systemd service template in NixOS? [https://stackoverflow.com/questions/69355197/how-to-create-a-systemd-service-template-in-nixos stackoverflow]"
      },
      "date": 1693995523671
    },
    {
      "type": "edit",
      "id": "e34e29e73d5eeb94",
      "item": {
        "type": "paragraph",
        "id": "e34e29e73d5eeb94",
        "text": "How do I run a node.js app as a background service?"
      },
      "date": 1693997476863
    },
    {
      "type": "edit",
      "id": "e34e29e73d5eeb94",
      "item": {
        "type": "paragraph",
        "id": "e34e29e73d5eeb94",
        "text": "How do I run a node.js app as a background service? [https://stackoverflow.com/questions/4018154/how-do-i-run-a-node-js-app-as-a-background-service stackoverflow]"
      },
      "date": 1693997489072
    },
    {
      "item": {
        "type": "factory",
        "id": "23e6ec9ff041ed3b"
      },
      "id": "23e6ec9ff041ed3b",
      "type": "add",
      "after": "e34e29e73d5eeb94",
      "date": 1693997567357
    },
    {
      "type": "edit",
      "id": "23e6ec9ff041ed3b",
      "item": {
        "type": "paragraph",
        "id": "23e6ec9ff041ed3b",
        "text": "The ultimate guide to deploying your node app on Linux"
      },
      "date": 1693997570056
    },
    {
      "type": "edit",
      "id": "23e6ec9ff041ed3b",
      "item": {
        "type": "paragraph",
        "id": "23e6ec9ff041ed3b",
        "text": "The ultimate guide to deploying your node app on Linux [https://web.archive.org/web/20180212163211/https://certsimple.com/blog/deploy-node-on-linux archive]"
      },
      "date": 1693997581425
    },
    {
      "item": {
        "type": "factory",
        "id": "70cf396f6bc32cec"
      },
      "id": "70cf396f6bc32cec",
      "type": "add",
      "after": "23e6ec9ff041ed3b",
      "date": 1693998174275
    },
    {
      "type": "edit",
      "id": "70cf396f6bc32cec",
      "item": {
        "type": "paragraph",
        "id": "70cf396f6bc32cec",
        "text": "Running npm start from ExecStart in systemctl service file"
      },
      "date": 1693998176570
    },
    {
      "type": "edit",
      "id": "70cf396f6bc32cec",
      "item": {
        "type": "paragraph",
        "id": "70cf396f6bc32cec",
        "text": "Running npm start from ExecStart in systemctl service file [https://stackoverflow.com/questions/64353905/running-npm-start-from-execstart-in-systemctl-service-file stackoverflow]"
      },
      "date": 1693998248645
    },
    {
      "item": {
        "type": "factory",
        "id": "364ae6da69bfe466"
      },
      "id": "364ae6da69bfe466",
      "type": "add",
      "after": "70cf396f6bc32cec",
      "date": 1693998736719
    },
    {
      "type": "edit",
      "id": "364ae6da69bfe466",
      "item": {
        "type": "code",
        "id": "364ae6da69bfe466",
        "text": "Sep 06 13:08:58 dreyeck systemd[1]: elm-pages.service: Failed with result 'exit-code'.\nSep 06 13:08:58 dreyeck systemd[1]: elm-pages.service: Main process exited, code=exited, status=254/n/a\nSep 06 13:08:58 dreyeck npm[132744]: npm ERR!     /home/rgb/.npm/_logs/2023-09-06T11_08_57_849Z-debug-0.log\nSep 06 13:08:58 dreyeck npm[132744]: npm ERR! A complete log of this run can be found in:\nSep 06 13:08:58 dreyeck npm[132744]: npm ERR! enoent\nSep 06 13:08:58 dreyeck npm[132744]: npm ERR! enoent This is related to npm not being able to find a file.\nSep 06 13:08:58 dreyeck npm[132744]: npm ERR! enoent spawn sh ENOENT\nSep 06 13:08:58 dreyeck npm[132744]: npm ERR! errno -2\nSep 06 13:08:58 dreyeck npm[132744]: npm ERR! path /home/rgb/.wiki/blog.dreyeck.ch/elm-pages-starter-express\nSep 06 13:08:58 dreyeck npm[132744]: npm ERR! syscall spawn sh\nSep 06 13:08:58 dreyeck npm[132744]: npm ERR! code ENOENT\nSep 06 13:08:57 dreyeck npm[132744]: > node dist-server/server.mjs\nSep 06 13:08:57 dreyeck npm[132744]: > start\nSep 06 13:08:57 dreyeck systemd[1]: Started blog.dreyeck.ch/elm-pages-starter-express.\nSep 06 13:06:37 dreyeck systemd[1]: elm-pages.service: Failed with result 'exit-code'.\nSep 06 13:06:37 dreyeck systemd[1]: elm-pages.service: Main process exited, code=exited, status=203/EXEC\nSep 06 13:06:37 dreyeck systemd[1]: Started blog.dreyeck.ch/elm-pages-starter-express."
      },
      "date": 1693998738471
    },
    {
      "item": {
        "type": "factory",
        "id": "96df6d95928c03c6"
      },
      "id": "96df6d95928c03c6",
      "type": "add",
      "after": "364ae6da69bfe466",
      "date": 1693998883856
    },
    {
      "type": "edit",
      "id": "96df6d95928c03c6",
      "item": {
        "type": "code",
        "id": "96df6d95928c03c6",
        "text": "warning: the following units failed: elm-pages.service\n\n× elm-pages.service - blog.dreyeck.ch/elm-pages-starter-express\n     Loaded: loaded (/etc/systemd/system/elm-pages.service; enabled; preset: enabled)\n     Active: failed (Result: exit-code) since Wed 2023-09-06 13:14:19 CEST; 224ms ago\n   Duration: 867ms\n    Process: 134345 ExecStart=/run/current-system/sw/bin/npm start (code=exited, status=254)\n   Main PID: 134345 (code=exited, status=254)\n         IP: 0B in, 0B out\n        CPU: 653ms\n\nSep 06 13:14:19 dreyeck npm[134345]: npm ERR! syscall spawn sh\nSep 06 13:14:19 dreyeck npm[134345]: npm ERR! path /home/rgb/.wiki/blog.dreyeck.ch/elm-pages-starter-express\nSep 06 13:14:19 dreyeck npm[134345]: npm ERR! errno -2\nSep 06 13:14:19 dreyeck npm[134345]: npm ERR! enoent spawn sh ENOENT\nSep 06 13:14:19 dreyeck npm[134345]: npm ERR! enoent This is related to npm not being able to find a file.\nSep 06 13:14:19 dreyeck npm[134345]: npm ERR! enoent\nSep 06 13:14:19 dreyeck npm[134345]: npm ERR! A complete log of this run can be found in:\nSep 06 13:14:19 dreyeck npm[134345]: npm ERR!     /home/rgb/.npm/_logs/2023-09-06T11_14_19_840Z-debug-0.log\nSep 06 13:14:19 dreyeck systemd[1]: elm-pages.service: Main process exited, code=exited, status=254/n/a\nSep 06 13:14:19 dreyeck systemd[1]: elm-pages.service: Failed with result 'exit-code'.\nwarning: error(s) occurred while switching to the new configuration"
      },
      "date": 1693998892863
    },
    {
      "id": "96df6d95928c03c6",
      "type": "move",
      "order": [
        "23e6ec9ff041ed3b",
        "70cf396f6bc32cec",
        "96df6d95928c03c6",
        "364ae6da69bfe466",
        "42938d64ed613e86",
        "4eeb0c0ebd9d9e60",
        "9065ec3ed86fbd88",
        "bc21d42d7118eeef",
        "cbfbebfef9a7bcd1",
        "90ecc08458ac00e4",
        "f840a62e1a48e5bb",
        "939f3c8060e3028c"
      ],
      "date": 1693998991282
    },
    {
      "type": "add",
      "id": "3bcec92d7a1295d4",
      "item": {
        "type": "paragraph",
        "id": "3bcec92d7a1295d4",
        "text": "[[elm-pages.service]]"
      },
      "after": "70cf396f6bc32cec",
      "date": 1693999036810
    },
    {
      "id": "96df6d95928c03c6",
      "type": "move",
      "order": [
        "23e6ec9ff041ed3b",
        "70cf396f6bc32cec",
        "96df6d95928c03c6",
        "3bcec92d7a1295d4",
        "364ae6da69bfe466",
        "42938d64ed613e86",
        "4eeb0c0ebd9d9e60",
        "9065ec3ed86fbd88",
        "bc21d42d7118eeef",
        "cbfbebfef9a7bcd1",
        "90ecc08458ac00e4",
        "f840a62e1a48e5bb",
        "939f3c8060e3028c"
      ],
      "date": 1693999048386
    },
    {
      "id": "96df6d95928c03c6",
      "type": "remove",
      "removedTo": {
        "page": "elm-pages.service"
      },
      "date": 1693999052169
    },
    {
      "id": "364ae6da69bfe466",
      "type": "remove",
      "removedTo": {
        "page": "elm-pages.service"
      },
      "date": 1693999096119
    },
    {
      "id": "23e6ec9ff041ed3b",
      "type": "remove",
      "removedTo": {
        "page": "elm-pages.service"
      },
      "date": 1693999146709
    },
    {
      "id": "70cf396f6bc32cec",
      "type": "remove",
      "removedTo": {
        "page": "elm-pages.service"
      },
      "date": 1693999149690
    },
    {
      "id": "3bcec92d7a1295d4",
      "type": "move",
      "order": [
        "42938d64ed613e86",
        "4eeb0c0ebd9d9e60",
        "9065ec3ed86fbd88",
        "3bcec92d7a1295d4",
        "bc21d42d7118eeef",
        "cbfbebfef9a7bcd1",
        "90ecc08458ac00e4",
        "f840a62e1a48e5bb",
        "939f3c8060e3028c"
      ],
      "date": 1693999154526
    },
    {
      "type": "edit",
      "id": "3bcec92d7a1295d4",
      "item": {
        "type": "paragraph",
        "id": "3bcec92d7a1295d4",
        "text": "⇒ [[elm-pages.service]]"
      },
      "date": 1693999162818
    },
    {
      "id": "90ecc08458ac00e4",
      "type": "remove",
      "removedTo": {
        "page": "elm-pages.service"
      },
      "date": 1693999171359
    },
    {
      "id": "f840a62e1a48e5bb",
      "type": "remove",
      "removedTo": {
        "page": "elm-pages.service"
      },
      "date": 1693999175316
    },
    {
      "id": "939f3c8060e3028c",
      "type": "remove",
      "removedTo": {
        "page": "elm-pages.service"
      },
      "date": 1693999298685
    },
    {
      "type": "remove",
      "id": "cbfbebfef9a7bcd1",
      "date": 1693999630233
    },
    {
      "type": "edit",
      "id": "4eeb0c0ebd9d9e60",
      "item": {
        "type": "paragraph",
        "id": "4eeb0c0ebd9d9e60",
        "text": "wiki.nix –  systemd.services.wiki ⇒ [[Systemd Hardening]]. [https://nixos.wiki/wiki/Systemd_Hardening page]"
      },
      "date": 1693999636108
    },
    {
      "type": "edit",
      "id": "4eeb0c0ebd9d9e60",
      "item": {
        "type": "paragraph",
        "id": "4eeb0c0ebd9d9e60",
        "text": "wiki.nix –  systemd.services.wiki ⇒ [[Systemd Hardening]]"
      },
      "date": 1693999648620
    },
    {
      "type": "remove",
      "id": "bc21d42d7118eeef",
      "date": 1693999654381
    },
    {
      "id": "9065ec3ed86fbd88",
      "type": "move",
      "order": [
        "42938d64ed613e86",
        "9065ec3ed86fbd88",
        "4eeb0c0ebd9d9e60",
        "3bcec92d7a1295d4"
      ],
      "date": 1693999666984
    },
    {
      "type": "edit",
      "id": "4eeb0c0ebd9d9e60",
      "item": {
        "type": "paragraph",
        "id": "4eeb0c0ebd9d9e60",
        "text": "wiki.nix –  systemd.services.wiki [⇒ [[Systemd Hardening]]]"
      },
      "date": 1693999692522
    },
    {
      "type": "remove",
      "id": "3bcec92d7a1295d4",
      "date": 1693999705621
    },
    {
      "type": "edit",
      "id": "4eeb0c0ebd9d9e60",
      "item": {
        "type": "paragraph",
        "id": "4eeb0c0ebd9d9e60",
        "text": "wiki.nix –  systemd.services.wiki [⇒ [[Systemd Hardening]]] ⇒ [[elm-pages.service]]"
      },
      "date": 1693999707483
    }
  ]
}