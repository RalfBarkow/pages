{
  "title": "Bluetooth Low Energy",
  "story": [
    {
      "type": "paragraph",
      "id": "8713f1800ad1ca8f",
      "text": "BLE is short for Bluetooth Low Energy, a communication stack designed specifically for communication between IoT devices that support BLE. [https://docs.toit.io/tutorials/ble toit]"
    },
    {
      "type": "paragraph",
      "id": "0187b675696e2fde",
      "text": "Heart rate monitor"
    },
    {
      "type": "code",
      "id": "6fbbbf2a847553ce",
      "text": "// Copyright (C) 2021 Toitware ApS.\n// Use of this source code is governed by a Zero-Clause BSD license that can\n// be found in the examples/LICENSE file.\n\n// The standard BLE peripheral demo for simulating a heart rate monitor.\n\nimport ble show *\nimport uuid show Uuid\n\nGATT_IO_UUID ::= 0x1825\n\nmain:\n  config := ServerConfiguration\n\n  service := config.add_service\n    uuid GATT_IO_UUID\n\n  /* Characteristic: SEND DATA */\n  heart_rate_send := service.add_notification_characteristic\n    Uuid #[0x63, 0x4b, 0x3c, 0x6e, 0xac, 0x41, 0x40, 0x85,\n           0xa9, 0x7c, 0xdd, 0x68, 0x7f, 0xa1, 0xe5, 0x0d]\n\n  /* Characteristic: RECEIVE DATA */\n  heart_rate_receive := service.add_write_only_characteristic\n    Uuid #[0x63, 0x4b, 0x3c, 0x6e, 0x1c, 0x41, 0x40, 0x85,\n           0xa9, 0x7c, 0xdd, 0x68, 0x7f, 0xa1, 0xe5, 0x0d]\n\n  device := Device.default config\n\n  advertiser := device.advertise\n  advertiser.set_data\n    AdvertisementData\n        --name=\"Toit heart rate demo\"\n\n  advertiser.start --connection_mode=BLE_CONNECT_MODE_UNDIRECTIONAL\n\n  task::\n    while true:\n      device.wait_for_client_connected\n      print \"Client connected\"\n      advertiser.close\n      device.wait_for_client_disconnected\n      print \"Client disconnected\"\n      advertiser.start --connection_mode=BLE_CONNECT_MODE_UNDIRECTIONAL\n\n  task::\n    simulated_heart_rate := 60\n    while true:\n      sleep --ms=500\n      heart_rate_send.value = #[0x06, simulated_heart_rate]\n      simulated_heart_rate++\n      if simulated_heart_rate == 130: simulated_heart_rate = 60\n\n  while true:\n    print\n      \"Heart rate app received data $(heart_rate_receive.value)\"\n"
    }
  ],
  "journal": [
    {
      "type": "create",
      "item": {
        "title": "Bluetooth Low Energy",
        "story": []
      },
      "date": 1662974346232
    },
    {
      "item": {
        "type": "factory",
        "id": "8713f1800ad1ca8f"
      },
      "id": "8713f1800ad1ca8f",
      "type": "add",
      "date": 1662974355047
    },
    {
      "type": "edit",
      "id": "8713f1800ad1ca8f",
      "item": {
        "type": "paragraph",
        "id": "8713f1800ad1ca8f",
        "text": "â€“ [https://docs.toit.io/tutorials/ble toit]"
      },
      "date": 1662974366958
    },
    {
      "type": "edit",
      "id": "8713f1800ad1ca8f",
      "item": {
        "type": "paragraph",
        "id": "8713f1800ad1ca8f",
        "text": "BLE is short for Bluetooth Low Energy, a communication stack designed specifically for communication between IoT devices that support BLE. [https://docs.toit.io/tutorials/ble toit]"
      },
      "date": 1662974381333
    },
    {
      "item": {
        "type": "factory",
        "id": "6fbbbf2a847553ce"
      },
      "id": "6fbbbf2a847553ce",
      "type": "add",
      "after": "8713f1800ad1ca8f",
      "date": 1662974451753
    },
    {
      "type": "edit",
      "id": "6fbbbf2a847553ce",
      "item": {
        "type": "code",
        "id": "6fbbbf2a847553ce",
        "text": "// Copyright (C) 2021 Toitware ApS.\n// Use of this source code is governed by a Zero-Clause BSD license that can\n// be found in the examples/LICENSE file.\n\n// The standard BLE peripheral demo for simulating a heart rate monitor.\n\nimport ble show *\nimport uuid show Uuid\n\nGATT_IO_UUID ::= 0x1825\n\nmain:\n  config := ServerConfiguration\n\n  service := config.add_service\n    uuid GATT_IO_UUID\n\n  /* Characteristic: SEND DATA */\n  heart_rate_send := service.add_notification_characteristic\n    Uuid #[0x63, 0x4b, 0x3c, 0x6e, 0xac, 0x41, 0x40, 0x85,\n           0xa9, 0x7c, 0xdd, 0x68, 0x7f, 0xa1, 0xe5, 0x0d]\n\n  /* Characteristic: RECEIVE DATA */\n  heart_rate_receive := service.add_write_only_characteristic\n    Uuid #[0x63, 0x4b, 0x3c, 0x6e, 0x1c, 0x41, 0x40, 0x85,\n           0xa9, 0x7c, 0xdd, 0x68, 0x7f, 0xa1, 0xe5, 0x0d]\n\n  device := Device.default config\n\n  advertiser := device.advertise\n  advertiser.set_data\n    AdvertisementData\n        --name=\"Toit heart rate demo\"\n\n  advertiser.start --connection_mode=BLE_CONNECT_MODE_UNDIRECTIONAL\n\n  task::\n    while true:\n      device.wait_for_client_connected\n      print \"Client connected\"\n      advertiser.close\n      device.wait_for_client_disconnected\n      print \"Client disconnected\"\n      advertiser.start --connection_mode=BLE_CONNECT_MODE_UNDIRECTIONAL\n\n  task::\n    simulated_heart_rate := 60\n    while true:\n      sleep --ms=500\n      heart_rate_send.value = #[0x06, simulated_heart_rate]\n      simulated_heart_rate++\n      if simulated_heart_rate == 130: simulated_heart_rate = 60\n\n  while true:\n    print\n      \"Heart rate app received data $(heart_rate_receive.value)\"\n"
      },
      "date": 1662974453876
    },
    {
      "type": "add",
      "id": "0187b675696e2fde",
      "item": {
        "type": "paragraph",
        "id": "0187b675696e2fde",
        "text": "Heart rate monitor"
      },
      "after": "8713f1800ad1ca8f",
      "date": 1662974518771
    }
  ]
}